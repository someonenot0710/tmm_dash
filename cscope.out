cscope 15 $HOME/tmm/repos/ns-3-allinone/ns-3-dev/src/dash               0000085962
	@examples/dash-example.cc

27 
	~<¡ršg
>

28 
	~<f¡»am
>

29 
	~"ns3/cÜe-moduË.h
"

30 
	~"ns3/pošt-to-pošt-moduË.h
"

31 
	~"ns3/š‹º‘-moduË.h
"

32 
	~"ns3/­¶iÿtiÚs-moduË.h
"

33 
	~"ns3/ÃtwÜk-moduË.h
"

34 
	~"ns3/dash-moduË.h
"

35 
	~"../mod–/·¿.h
"

36 
usšg
 
Çme¥aû
 
	gns3
;

37 
usšg
 
Çme¥aû
 
	g¡d
;

38 
NS_LOG_COMPONENT_DEFINE
("DashExample");

40 
	#SIZE
 100

	)

41 
	glše
[
SIZE
];

45 
	$maš
(
¬gc
, *
¬gv
[])

47 
boŞ
 
Œacšg
 = 
çl£
;

48 
ušt32_t
 
maxBy‹s
 = 100;

49 
ušt32_t
 
u£rs
 = 1;

50 
rg‘_dt
 = 35.0;

51 
¡İTime
 = 100.0;

52 
¡d
::
¡ršg
 
lškR©e
 = "500Kbps";

53 
¡d
::
¡ršg
 
d–ay
 = "5ms";

54 
¡d
::
¡ršg
 
´ÙocŞ
 = "ns3::DashClient";

55 
¡d
::
¡ršg
 
wšdow
 = "10s";

64 
CommªdLše
 
cmd
;

65 
cmd
.
	`AddV®ue
("Œacšg", "FÏgØ’abË/di§bË¿cšg", 
Œacšg
);

66 
cmd
.
	`AddV®ue
("maxBytes", "Total‚umber of bytes for‡pplicationo send",

67 
maxBy‹s
);

68 
cmd
.
	`AddV®ue
("u£rs", "Thnumb” oàcÚcu¼’ˆvideos", 
u£rs
);

69 
cmd
.
	`AddV®ue
("targetDt",

71 
rg‘_dt
);

72 
cmd
.
	`AddV®ue
("stopTime",

73 "Thtimwh’hş›Á wÈ¡İ„eque¡šg segm’ts", 
¡İTime
);

74 
cmd
.
	`AddV®ue
("linkRate",

76 
lškR©e
);

77 
cmd
.
	`AddV®ue
("delay",

79 
d–ay
);

80 
cmd
.
	`AddV®ue
("protocol",

82 
´ÙocŞ
);

83 
cmd
.
	`AddV®ue
("window",

84 "Thwšdow fÜ m—suršghav”agthroughpuˆ(Time).", 
wšdow
);

86 
cmd
.
	`AddV®ue
("in_file",

87 "špuˆfe", 
check‹¡
);

88 
cmd
.
	`P¬£
(
¬gc
, 
¬gv
);

92 
if¡»am
 
	`fe
("landscape5x5_10s_high.csv");

93 
¡ršg
 
¡r
;

94 if(!
fe
è
cout
<<"nØfe"<<
’dl
;

95 
	`g‘lše
(
fe
,
¡r
)){

96 
video_num
.
	`push_back
(
	`¡oi
(
¡r
));

99 
size_t
 
j
=0, 
max
=
video_num
.
	`size
() ;j!=max;j++){

100 
cout
<<
video_num
[
j
]<<
’dl
;

102 
cout
<<"good"<<
’dl
;

116 
	`NS_LOG_INFO
("Create‚odes.");

117 
NodeCÚš”
 
nodes
;

118 
nodes
.
	`C»©e
(2);

120 
	`NS_LOG_INFO
("Create channels.");

125 
PoštToPoštH–³r
 
poštToPošt
;

126 
poštToPošt
.
	`S‘DeviûA‰ribu‹
("D©aR©e", 
	`SŒšgV®ue
(
lškR©e
));

127 
poštToPošt
.
	`S‘ChªÃlA‰ribu‹
("D–ay", 
	`SŒšgV®ue
(
d–ay
));

128 
N‘DeviûCÚš”
 
deviûs
;

129 
deviûs
 = 
poštToPošt
.
	`In¡®l
(
nodes
);

134 
IÁ”ÃtSckH–³r
 
š‹º‘
;

135 
š‹º‘
.
	`In¡®l
(
nodes
);

140 
	`NS_LOG_INFO
("Assign IP Addresses.");

141 
Ipv4Add»ssH–³r
 
v4
;

142 
Ipv4IÁ”çûCÚš”
 
i
 = 
v4
.
	`Assign
(
deviûs
);

144 
	`NS_LOG_INFO
("Create Applications.");

146 
¡d
::
veùÜ
<¡d::
¡ršg
> 
´ÙocŞs
;

147 
¡d
::
¡ršg¡»am
 
	`ss
(
´ÙocŞ
);

148 
¡d
::
¡ršg
 
´Ùo
;

149 
ušt32_t
 
´ÙoNum
 = 0;

150 
¡d
::
	`g‘lše
(
ss
, 
´Ùo
, ','è&& 
´ÙoNum
++ < 
u£rs
)

152 
´ÙocŞs
.
	`push_back
(
´Ùo
);

155 
ušt16_t
 
pÜt
 = 80;

156 
¡d
::
veùÜ
<
DashCl›ÁH–³r
> 
ş›Ás
;

157 
¡d
::
veùÜ
<
AµliÿtiÚCÚš”
> 
ş›ÁAµs
;

160 
ušt32_t
 
u£r
 = 0; u£¸< 
u£rs
; user++)

162 
DashCl›ÁH–³r
 
	`ş›Á
("ns3::TcpSocketFactory",

163 
	`IÃtSock‘Add»ss
(
i
.
	`G‘Add»ss
(1), 
pÜt
), 
´ÙocŞs
[
u£r
 % 
´ÙoNum
]);

165 
ş›Á
.
	`S‘A‰ribu‹
("VideoId", 
	`Uš‹g”V®ue
(
u£r
 + 1));

166 
ş›Á
.
	`S‘A‰ribu‹
("T¬g‘Dt", 
	`TimeV®ue
(
	`SecÚds
(
rg‘_dt
)));

167 
ş›Á
.
	`S‘A‰ribu‹
("wšdow", 
	`TimeV®ue
(
	`Time
(
wšdow
)));

168 
AµliÿtiÚCÚš”
 
ş›ÁAµ
 = 
ş›Á
.
	`In¡®l
(
nodes
.
	`G‘
(0));

169 
ş›ÁAµ
.
	`S¹
(
	`SecÚds
(0.25+
u£r
*100));

172 
ş›Ás
.
	`push_back
(
ş›Á
);

173 
ş›ÁAµs
.
	`push_back
(
ş›ÁAµ
);

177 
DashS”v”H–³r
 
	`£rv”
("ns3::TcpSocketFactory",

178 
	`IÃtSock‘Add»ss
(
Ipv4Add»ss
::
	`G‘Any
(), 
pÜt
));

179 
AµliÿtiÚCÚš”
 
£rv”Aµs
 = 
£rv”
.
	`In¡®l
(
nodes
.
	`G‘
(1));

180 
£rv”Aµs
.
	`S¹
(
	`SecÚds
(0.0));

186 ià(
Œacšg
)

188 
AsciiT¿ûH–³r
 
ascii
;

189 
poštToPošt
.
	`EÇbËAsciiAÎ
(
ascii
.
	`C»©eFeSŒ—m
("dash-send.tr"));

190 
poštToPošt
.
	`EÇbËPÿpAÎ
("dash-£nd", 
çl£
);

195 
	`NS_LOG_INFO
("Run Simulation.");

197 
SimuÏtÜ
::
	`Run
();

198 
SimuÏtÜ
::
	`De¡roy
();

199 
	`NS_LOG_INFO
("Done.");

202 
ušt32_t
 
k
;

203 
k
 = 0; k < 
u£rs
; k++)

205 
PŒ
<
DashCl›Á
> 
­p
 = 
DyÇmicCa¡
<DashCl›Á>(
ş›ÁAµs
[
k
].
	`G‘
(0));

206 
¡d
::
cout
 << 
´ÙocŞs
[
k
 % 
´ÙoNum
] << "-Node: " << k;

207 
­p
->
	`G‘Sts
();

212 
	}
}

	@examples/dash-wifi.cc

21 
	~"ns3/cÜe-moduË.h
"

22 
	~"ns3/ÃtwÜk-moduË.h
"

23 
	~"ns3/­¶iÿtiÚs-moduË.h
"

24 
	~"ns3/wifi-moduË.h
"

25 
	~"ns3/mob™y-moduË.h
"

26 
	~"ns3/csma-moduË.h
"

27 
	~"ns3/š‹º‘-moduË.h
"

28 
	~"ns3/Ãnim-moduË.h
"

29 
	~"ns3/Ş¤-h–³r.h
"

30 
	~"ns3/dash-moduË.h
"

32 
usšg
 
Çme¥aû
 
	gns3
;

33 
NS_LOG_COMPONENT_DEFINE
("Dash-Wifi");

36 
	$maš
(
¬gc
, *
¬gv
[])

38 
ušt32_t
 
nWifi
 = 8;

39 
ušt32_t
 
maxBy‹s
 = 0;

40 
ušt32_t
 
u£rs
 = 1;

41 
ušt32_t
 
bulkNo
 = 1;

42 
rg‘_dt
 = 35.0;

43 
¡İTime
 = 100.0;

44 
¡d
::
¡ršg
 
lškR©e
 = "500Kbps";

45 
¡d
::
¡ršg
 
d–ay
 = "5ms";

46 
¡d
::
¡ršg
 
´ÙocŞ
 = "ns3::DashClient";

47 
¡d
::
¡ršg
 
wšdow
 = "10s";

56 
CommªdLše
 
cmd
;

57 
cmd
.
	`AddV®ue
("nWifi", "Numb” oàwif˜STA deviûs", 
nWifi
);

58 
cmd
.
	`AddV®ue
("maxBytes", "Total‚umber of bytes for‡pplicationo send",

59 
maxBy‹s
);

60 
cmd
.
	`AddV®ue
("u£rs", "Thnumb” oàcÚcu¼’ˆvideos", 
u£rs
);

61 
cmd
.
	`AddV®ue
("bulkNo", "Thnumb” oàbackground TCP¿nsãrs", 
bulkNo
);

62 
cmd
.
	`AddV®ue
("targetDt",

64 
rg‘_dt
);

65 
cmd
.
	`AddV®ue
("stopTime",

66 "Thtimwh’hş›Á wÈ¡İ„eque¡šg segm’ts", 
¡İTime
);

67 
cmd
.
	`AddV®ue
("linkRate",

69 
lškR©e
);

70 
cmd
.
	`AddV®ue
("delay",

72 
d–ay
);

73 
cmd
.
	`AddV®ue
("protocol",

75 
´ÙocŞ
);

76 
cmd
.
	`AddV®ue
("window",

77 "Thwšdow fÜ m—suršghav”agthroughpuˆ(Time).", 
wšdow
);

78 
cmd
.
	`P¬£
(
¬gc
, 
¬gv
);

80 ià(
bulkNo
 + 
u£rs
 > 
nWifi
 + 1)

82 
¡d
::
û¼
 << "you‚“d mÜ¡©iÚs" << std::
’dl
;

86 
¡d
::
cout
 << "nWifiğ" << 
nWifi
 << std::
’dl
;

88 
	`LogCompÚ’tEÇbË
("UdpCl›Á", 
LOG_LEVEL_INFO
);

89 
	`LogCompÚ’tEÇbË
("UdpS”v”", 
LOG_LEVEL_INFO
);

91 
NodeCÚš”
 
wifiSNodes
;

92 
wifiSNodes
.
	`C»©e
(
nWifi
);

94 
YªsWifiChªÃlH–³r
 
chªÃl
 = YªsWifiChªÃlH–³r::
	`DeçuÉ
();

95 
YªsWifiPhyH–³r
 
phy
 = YªsWifiPhyH–³r::
	`DeçuÉ
();

96 
phy
.
	`S‘ChªÃl
(
chªÃl
.
	`C»©e
());

99 
WifiH–³r
 
wifi
 = 
	`WifiH–³r
();

100 
wifi
.
	`S‘RemÙeStiÚMªag”
("ns3::AarfWifiManager");

101 
NqosWifiMacH–³r
 
mac
 = NqosWifiMacH–³r::
	`DeçuÉ
();

103 
N‘DeviûCÚš”
 
¡aDeviûs
;

104 
¡aDeviûs
 = 
wifi
.
	`In¡®l
(
phy
, 
mac
, 
wifiSNodes
);

106 
Mob™yH–³r
 
mob™y
;

107 
mob™y
.
	`S‘Pos™iÚAÎoÿtÜ
("ns3::GridPositionAllocator", "MinX",

108 
	`DoubËV®ue
(0.0), "MinY", DoubleValue(0.0), "DeltaX", DoubleValue(40.0),

109 "D–Y", 
	`DoubËV®ue
(50.0), "GridWidth", 
	`Uš‹g”V®ue
(2), "LayoutType",

110 
	`SŒšgV®ue
("RowFirst"));

112 
mob™y
.
	`S‘Mob™yMod–
("ns3::ConstantPositionMobilityModel");

113 
mob™y
.
	`In¡®l
(
wifiSNodes
);

115 
IÁ”ÃtSckH–³r
 
¡ack
;

116 
¡ack
.
	`In¡®l
(
wifiSNodes
);

117 
Ipv4Add»ssH–³r
 
add»ss
;

118 
add»ss
.
	`S‘Ba£
("10.1.2.0", "255.255.255.0");

119 
Ipv4IÁ”çûCÚš”
 
š‹rçûs
 = 
add»ss
.
	`Assign
(
¡aDeviûs
);

122 
¡d
::
veùÜ
<¡d::
¡ršg
> 
´ÙocŞs
;

123 
¡d
::
¡ršg¡»am
 
	`ss
(
´ÙocŞ
);

124 
¡d
::
¡ršg
 
´Ùo
;

125 
ušt32_t
 
´ÙoNum
 = 0;

126 
¡d
::
	`g‘lše
(
ss
, 
´Ùo
, ','è&& 
´ÙoNum
++ < 
u£rs
)

128 
´ÙocŞs
.
	`push_back
(
´Ùo
);

131 
ušt16_t
 
pÜt
 = 80;

133 
¡d
::
veùÜ
<
DashCl›ÁH–³r
> 
ş›Ás
;

134 
¡d
::
veùÜ
<
AµliÿtiÚCÚš”
> 
ş›ÁAµs
;

136 
ušt32_t
 
u£r
 = 0; u£¸< 
u£rs
; user++)

138 
DashCl›ÁH–³r
 
	`ş›Á
("ns3::TcpSocketFactory",

139 
	`IÃtSock‘Add»ss
(
š‹rçûs
.
	`G‘Add»ss
(0), 
pÜt
),
´ÙocŞs
[
u£r
 % 
´ÙoNum
]);

141 
ş›Á
.
	`S‘A‰ribu‹
("VideoId", 
	`Uš‹g”V®ue
(
u£r
 + 1));

142 
ş›Á
.
	`S‘A‰ribu‹
("T¬g‘Dt", 
	`TimeV®ue
(
	`SecÚds
(
rg‘_dt
)));

143 
ş›Á
.
	`S‘A‰ribu‹
("wšdow", 
	`TimeV®ue
(
	`Time
(
wšdow
)));

144 
AµliÿtiÚCÚš”
 
ş›ÁAµ
 = 
ş›Á
.
	`In¡®l
(
wifiSNodes
.
	`G‘
(
u£r
 + 1));

145 
ş›ÁAµ
.
	`S¹
(
	`SecÚds
(0.25));

146 
ş›ÁAµ
.
	`Stİ
(
	`SecÚds
(
¡İTime
));

148 
ş›Ás
.
	`push_back
(
ş›Á
);

149 
ş›ÁAµs
.
	`push_back
(
ş›ÁAµ
);

153 
DashS”v”H–³r
 
	`£rv”
("ns3::TcpSocketFactory",

154 
	`IÃtSock‘Add»ss
(
Ipv4Add»ss
::
	`G‘Any
(), 
pÜt
));

155 
AµliÿtiÚCÚš”
 
£rv”Aµs
 = 
£rv”
.
	`In¡®l
(
wifiSNodes
.
	`G‘
(0));

156 
£rv”Aµs
.
	`S¹
(
	`SecÚds
(0.0));

157 
£rv”Aµs
.
	`Stİ
(
	`SecÚds
(
¡İTime
 + 5.0));

159 
ušt32_t
 
bulk
 = 0; bulk < 
bulkNo
; bulk++)

161 
BulkS’dH–³r
 
	`sourû
("ns3::TcpSocketFactory",

162 
	`IÃtSock‘Add»ss
(
š‹rçûs
.
	`G‘Add»ss
(1 + 
u£rs
 + 
bulk
), 
pÜt
));

164 
sourû
.
	`S‘A‰ribu‹
("MaxBy‹s", 
	`Uš‹g”V®ue
(
maxBy‹s
));

165 
AµliÿtiÚCÚš”
 
sourûAµs
 = 
sourû
.
	`In¡®l
(
wifiSNodes
.
	`G‘
(0));

166 
sourûAµs
.
	`S¹
(
	`SecÚds
(0.0));

167 
sourûAµs
.
	`Stİ
(
	`SecÚds
(
¡İTime
));

169 
Pack‘SškH–³r
 
	`sšk
("ns3::TcpSocketFactory",

170 
	`IÃtSock‘Add»ss
(
Ipv4Add»ss
::
	`G‘Any
(), 
pÜt
));

171 
AµliÿtiÚCÚš”
 
sškAµs
 = 
sšk
.
	`In¡®l
(

172 
wifiSNodes
.
	`G‘
(1 + 
u£rs
 + 
bulk
));

173 
sškAµs
.
	`S¹
(
	`SecÚds
(0.0));

174 
sškAµs
.
	`Stİ
(
	`SecÚds
(
¡İTime
));

191 
SimuÏtÜ
::
	`Stİ
(
	`SecÚds
(
¡İTime
));

192 
Anim©iÚIÁ”çû
 
	`ªim
("dash-wifi.xml");

193 
SimuÏtÜ
::
	`Run
();

194 
SimuÏtÜ
::
	`De¡roy
();

196 
ušt32_t
 
k
;

197 
k
 = 0; k < 
u£rs
; k++)

199 
PŒ
<
DashCl›Á
> 
­p
 = 
DyÇmicCa¡
<DashCl›Á>(
ş›ÁAµs
[
k
].
	`G‘
(0));

200 
¡d
::
cout
 << 
´ÙocŞs
[
k
 % 
´ÙoNum
] << "-Node: " << k;

201 
­p
->
	`G‘Sts
();

205 
	}
}

	@examples/link-example.cc

27 
	~<¡ršg
>

28 
	~<f¡»am
>

29 
	~"ns3/cÜe-moduË.h
"

30 
	~"ns3/pošt-to-pošt-moduË.h
"

31 
	~"ns3/š‹º‘-moduË.h
"

32 
	~"ns3/­¶iÿtiÚs-moduË.h
"

33 
	~"ns3/ÃtwÜk-moduË.h
"

34 
	~"ns3/dash-moduË.h
"

36 
usšg
 
Çme¥aû
 
	gns3
;

38 
NS_LOG_COMPONENT_DEFINE
("DashExample");

41 
C®lBack
(
PŒ
<
N‘Deviû
> 
deviû
, 
¡d
::
¡ršg
 
¿‹
)

43 
¡d
::
cout
 << "============================================\n"

44 "==ğCALLBACK:‚ew„©e: " << 
¿‹
 << " =====\n"

45 "============================================" << 
¡d
::
’dl
;

47 
	gdeviû
->
S‘A‰ribu‹
("D©aR©e", 
SŒšgV®ue
(
¿‹
));

52 
Sw™chC®lBack
(
PŒ
<
N‘Deviû
> 
deviû
, cÚ¡ 
¡d
::
¡ršg
 & 
sw™chTime
,

53 cÚ¡ 
¡d
::
¡ršg
 & 
lowR©e
, cÚ¡ std::¡ršg & 
highR©e
, 
boŞ
 
æag
)

56 
	g¡d
::
cout
 << "============================================\n"

57 "==ğCALLBACK:‚ew„©e: " << (
æag
 ? 
lowR©e
 : 
highR©e
) << " =====\n"

58 "============================================" << 
¡d
::
’dl
;

60 
	gdeviû
->
S‘A‰ribu‹
("DataRate",

61 
æag
 ? 
SŒšgV®ue
(
lowR©e
è: SŒšgV®ue(
highR©e
));

62 
	gæag
 = !
æag
;

64 
	gSimuÏtÜ
::
ScheduË
(
Time
(
sw™chTime
), 
Sw™chC®lBack
, 
deviû
, switchTime,

65 
lowR©e
, 
highR©e
, 
æag
);

69 
	$maš
(
¬gc
, *
¬gv
[])

71 
boŞ
 
Œacšg
 = 
çl£
;

72 
ušt32_t
 
maxBy‹s
 = 100;

73 
ušt32_t
 
u£rs
 = 1;

74 
rg‘_dt
 = 35.0;

75 
¡İTime
 = 500.0;

76 
lškHigh
 = 200.0;

77 
lškLow
 = 400.0;

78 
¡d
::
¡ršg
 
lškR©e
 = "1000000";

79 
¡d
::
¡ršg
 
highR©e
 = "2000000";

80 
¡d
::
¡ršg
 
lowR©e
 = "1000000";

81 
¡d
::
¡ršg
 
d–ay
 = "5ms";

82 
¡d
::
¡ršg
 
sw™chTime
 = "0s";

83 
¡d
::
¡ršg
 
sw™chS¹
 = "190s";

84 
¡d
::
¡ršg
 
´ÙocŞ
 = "ns3::DashClient";

85 
¡d
::
¡ršg
 
wšdow
 = "10s";

94 
CommªdLše
 
cmd
;

95 
cmd
.
	`AddV®ue
("Œacšg", "FÏgØ’abË/di§bË¿cšg", 
Œacšg
);

96 
cmd
.
	`AddV®ue
("maxBytes", "Total‚umber of bytes for‡pplicationo send",

97 
maxBy‹s
);

98 
cmd
.
	`AddV®ue
("u£rs", "Thnumb” oàcÚcu¼’ˆvideos", 
u£rs
);

99 
cmd
.
	`AddV®ue
("targetDt",

101 
rg‘_dt
);

102 
cmd
.
	`AddV®ue
("stopTime",

103 "Thtimwh’hş›Á wÈ¡İ„eque¡šg segm’ts", 
¡İTime
);

104 
cmd
.
	`AddV®ue
("linkRate",

106 
lškR©e
);

107 
cmd
.
	`AddV®ue
("delay",

109 
d–ay
);

110 
cmd
.
	`AddV®ue
("switchTime",

112 
sw™chTime
);

113 
cmd
.
	`AddV®ue
("protocol",

115 
´ÙocŞ
);

116 
cmd
.
	`AddV®ue
("window",

117 "Thwšdow fÜ m—suršghav”agthroughpuˆ(Time).", 
wšdow
);

118 
cmd
.
	`P¬£
(
¬gc
, 
¬gv
);

123 
	`NS_LOG_INFO
("Create‚odes.");

124 
NodeCÚš”
 
nodes
;

125 
nodes
.
	`C»©e
(2);

127 
	`NS_LOG_INFO
("Create channels.");

132 
PoštToPoštH–³r
 
poštToPošt
;

133 
poštToPošt
.
	`S‘DeviûA‰ribu‹
("D©aR©e", 
	`SŒšgV®ue
(
lškR©e
));

134 
poštToPošt
.
	`S‘ChªÃlA‰ribu‹
("D–ay", 
	`SŒšgV®ue
(
d–ay
));

136 
N‘DeviûCÚš”
 
deviûs
;

137 
deviûs
 = 
poštToPošt
.
	`In¡®l
(
nodes
);

139 ià(
	`Time
(
sw™chTime
è=ğ
	`SecÚds
(0))

141 
SimuÏtÜ
::
	`ScheduË
(
	`SecÚds
(
lškHigh
), 
C®lBack
, 
deviûs
.
	`G‘
(0),

142 
highR©e
);

143 
SimuÏtÜ
::
	`ScheduË
(
	`SecÚds
(
lškLow
), 
C®lBack
, 
deviûs
.
	`G‘
(0), 
lowR©e
);

144 
SimuÏtÜ
::
	`ScheduË
(
	`SecÚds
(
lškHigh
), 
C®lBack
, 
deviûs
.
	`G‘
(1),

145 
highR©e
);

146 
SimuÏtÜ
::
	`ScheduË
(
	`SecÚds
(
lškLow
), 
C®lBack
, 
deviûs
.
	`G‘
(1), 
lowR©e
);

150 
SimuÏtÜ
::
	`ScheduË
(
	`Time
(
sw™chS¹
), 
Sw™chC®lBack
, 
deviûs
.
	`G‘
(0),

151 
sw™chTime
, 
lowR©e
, 
highR©e
, 
çl£
);

152 
SimuÏtÜ
::
	`ScheduË
(
	`Time
(
sw™chS¹
), 
Sw™chC®lBack
, 
deviûs
.
	`G‘
(1),

153 
sw™chTime
, 
lowR©e
, 
highR©e
, 
çl£
);

158 
IÁ”ÃtSckH–³r
 
š‹º‘
;

159 
š‹º‘
.
	`In¡®l
(
nodes
);

164 
	`NS_LOG_INFO
("Assign IP Addresses.");

165 
Ipv4Add»ssH–³r
 
v4
;

166 
v4
.
	`S‘Ba£
("10.1.1.0", "255.255.255.0");

167 
Ipv4IÁ”çûCÚš”
 
i
 = 
v4
.
	`Assign
(
deviûs
);

169 
	`NS_LOG_INFO
("Create Applications.");

171 
¡d
::
veùÜ
<¡d::
¡ršg
> 
´ÙocŞs
;

172 
¡d
::
¡ršg¡»am
 
	`ss
(
´ÙocŞ
);

173 
¡d
::
¡ršg
 
´Ùo
;

174 
ušt32_t
 
´ÙoNum
 = 0;

175 
¡d
::
	`g‘lše
(
ss
, 
´Ùo
, ','è&& 
´ÙoNum
++ < 
u£rs
)

177 
´ÙocŞs
.
	`push_back
(
´Ùo
);

180 
ušt16_t
 
pÜt
 = 80;

182 
¡d
::
veùÜ
<
DashCl›ÁH–³r
> 
ş›Ás
;

183 
¡d
::
veùÜ
<
AµliÿtiÚCÚš”
> 
ş›ÁAµs
;

185 
ušt32_t
 
u£r
 = 0; u£¸< 
u£rs
; user++)

187 
DashCl›ÁH–³r
 
	`ş›Á
("ns3::TcpSocketFactory",

188 
	`IÃtSock‘Add»ss
(
i
.
	`G‘Add»ss
(1), 
pÜt
), 
´ÙocŞs
[
u£r
 % 
´ÙoNum
]);

190 
ş›Á
.
	`S‘A‰ribu‹
("T¬g‘Dt", 
	`TimeV®ue
(
	`SecÚds
(
rg‘_dt
)));

191 
ş›Á
.
	`S‘A‰ribu‹
("VideoId", 
	`Uš‹g”V®ue
(
u£r
 + 1));

192 
ş›Á
.
	`S‘A‰ribu‹
("wšdow",
	`TimeV®ue
(
	`Time
(
wšdow
)));

194 
AµliÿtiÚCÚš”
 
ş›ÁAµ
 = 
ş›Á
.
	`In¡®l
(
nodes
.
	`G‘
(0));

195 
ş›ÁAµ
.
	`S¹
(
	`SecÚds
(0.25));

196 
ş›ÁAµ
.
	`Stİ
(
	`SecÚds
(
¡İTime
));

198 
ş›Ás
.
	`push_back
(
ş›Á
);

199 
ş›ÁAµs
.
	`push_back
(
ş›ÁAµ
);

203 
DashS”v”H–³r
 
	`£rv”
("ns3::TcpSocketFactory",

204 
	`IÃtSock‘Add»ss
(
Ipv4Add»ss
::
	`G‘Any
(), 
pÜt
));

205 
AµliÿtiÚCÚš”
 
£rv”Aµs
 = 
£rv”
.
	`In¡®l
(
nodes
.
	`G‘
(1));

206 
£rv”Aµs
.
	`S¹
(
	`SecÚds
(0.0));

207 
£rv”Aµs
.
	`Stİ
(
	`SecÚds
(
¡İTime
 + 5.0));

212 ià(
Œacšg
)

214 
AsciiT¿ûH–³r
 
ascii
;

215 
poštToPošt
.
	`EÇbËAsciiAÎ
(
ascii
.
	`C»©eFeSŒ—m
("dash-send.tr"));

216 
poštToPošt
.
	`EÇbËPÿpAÎ
("dash-£nd", 
çl£
);

222 
	`NS_LOG_INFO
("Run Simulation.");

223 
SimuÏtÜ
::
	`Stİ
(
	`SecÚds
(
¡İTime
));

224 
SimuÏtÜ
::
	`Run
();

225 
SimuÏtÜ
::
	`De¡roy
();

226 
	`NS_LOG_INFO
("Done.");

228 
ušt32_t
 
k
;

229 
k
 = 0; k < 
u£rs
; k++)

231 
PŒ
<
DashCl›Á
> 
­p
 = 
DyÇmicCa¡
<DashCl›Á>(
ş›ÁAµs
[
k
].
	`G‘
(0));

232 
¡d
::
cout
 << 
´ÙocŞs
[
k
 % 
´ÙoNum
] << "-Node: " << k;

233 
­p
->
	`G‘Sts
();

236 
	}
}

	@helper/dash-client-helper.cc

23 
	~"dash-ş›Á-h–³r.h
"

24 
	~"ns3/š‘-sock‘-add»ss.h
"

25 
	~"ns3/·ck‘-sock‘-add»ss.h
"

26 
	~"ns3/¡ršg.h
"

27 
	~"ns3/Çmes.h
"

29 
Çme¥aû
 
	gns3
 {

31 
	gDashCl›ÁH–³r
::
DashCl›ÁH–³r
 (
¡d
::
¡ršg
 
tıPrÙocŞ
, 
Add»ss
 
add»ss
)

33 
	gm_çùÜy
.
S‘Ty³Id
 ("ns3::DashClient");

34 
	gm_çùÜy
.
S‘
 ("PrÙocŞ", 
SŒšgV®ue
 (
tıPrÙocŞ
));

35 
	gm_çùÜy
.
S‘
 ("RemÙe", 
Add»ssV®ue
 (
add»ss
));

38 
	gDashCl›ÁH–³r
::
DashCl›ÁH–³r
 (
¡d
::
¡ršg
 
tıPrÙocŞ
, 
Add»ss
 
add»ss
, std::¡ršg 
®gÜ™hm
)

40 
m_çùÜy
.
S‘Ty³Id
 (
®gÜ™hm
);

41 
	gm_çùÜy
.
S‘
 ("PrÙocŞ", 
SŒšgV®ue
 (
tıPrÙocŞ
));

42 
	gm_çùÜy
.
S‘
 ("RemÙe", 
Add»ssV®ue
 (
add»ss
));

45 
	gDashCl›ÁH–³r
::
S‘A‰ribu‹
 (
¡d
::
¡ršg
 
Çme
, cÚ¡ 
A‰ribu‹V®ue
 &
v®ue
)

47 
	gm_çùÜy
.
S‘
 (
Çme
, 
v®ue
);

50 
AµliÿtiÚCÚš”


51 
	gDashCl›ÁH–³r
::
In¡®l
 (
PŒ
<
Node
> 
node
) const

53  
AµliÿtiÚCÚš”
 (
In¡®lPriv
 (
node
));

56 
AµliÿtiÚCÚš”


57 
	gDashCl›ÁH–³r
::
In¡®l
 (
¡d
::
¡ršg
 
nodeName
) const

59 
PŒ
<
Node
> 
node
 = 
Names
::
Fšd
<Node> (
nodeName
);

60  
AµliÿtiÚCÚš”
 (
In¡®lPriv
 (
node
));

63 
AµliÿtiÚCÚš”


64 
	gDashCl›ÁH–³r
::
In¡®l
 (
NodeCÚš”
 
c
) const

66 
AµliÿtiÚCÚš”
 
­ps
;

67 
	gNodeCÚš”
::
I‹¿tÜ
 
i
 = 
c
.
Begš
 (); 
	gi
 !ğc.
End
 (); ++i)

69 
	g­ps
.
Add
 (
In¡®lPriv
 (*
i
));

72  
	g­ps
;

75 
	gPŒ
<
	gAµliÿtiÚ
>

76 
	gDashCl›ÁH–³r
::
In¡®lPriv
 (
PŒ
<
Node
> 
node
) const

78 
PŒ
<
AµliÿtiÚ
> 
­p
 = 
m_çùÜy
.
C»©e
<Application> ();

79 
	gnode
->
AddAµliÿtiÚ
 (
­p
);

81  
	g­p
;

	@helper/dash-client-helper.h

23 #iâdeà
DASH_CLIENT_HELPER_H


24 
	#DASH_CLIENT_HELPER_H


	)

26 
	~<¡dšt.h
>

27 
	~<¡ršg
>

28 
	~"ns3/objeù-çùÜy.h
"

29 
	~"ns3/add»ss.h
"

30 
	~"ns3/©Œibu‹.h
"

31 
	~"ns3/Ãt-deviû.h
"

32 
	~"ns3/node-cÚš”.h
"

33 
	~"ns3/­¶iÿtiÚ-cÚš”.h
"

35 
Çme¥aû
 
	gns3
 {

41 şas 
	cDashCl›ÁH–³r


43 
	gpublic
:

54 
DashCl›ÁH–³r
 (
¡d
::
¡ršg
 
tıPrÙocŞ
, 
Add»ss
 
add»ss
);

69 
DashCl›ÁH–³r
 (
¡d
::
¡ršg
 
tıPrÙocŞ
, 
Add»ss
 
add»ss
, std::¡ršg 
®gÜ™hm
);

78 
S‘A‰ribu‹
 (
¡d
::
¡ršg
 
Çme
, cÚ¡ 
A‰ribu‹V®ue
 &
v®ue
);

88 
AµliÿtiÚCÚš”
 
In¡®l
 (
NodeCÚš”
 
c
) const;

97 
AµliÿtiÚCÚš”
 
In¡®l
 (
PŒ
<
Node
> 
node
) const;

106 
AµliÿtiÚCÚš”
 
In¡®l
 (
¡d
::
¡ršg
 
nodeName
) const;

108 
	g´iv©e
:

117 
PŒ
<
AµliÿtiÚ
> 
In¡®lPriv
 (PŒ<
Node
> 
node
) const;

118 
	g¡d
::
¡ršg
 
m_´ÙocŞ
;

119 
Add»ss
 
	gm_»mÙe
;

120 
ObjeùFaùÜy
 
	gm_çùÜy
;

	@helper/dash-server-helper.cc

23 
	~"dash-£rv”-h–³r.h
"

24 
	~"ns3/¡ršg.h
"

25 
	~"ns3/š‘-sock‘-add»ss.h
"

26 
	~"ns3/Çmes.h
"

28 
Çme¥aû
 
	gns3
 {

30 
	gDashS”v”H–³r
::
DashS”v”H–³r
 (
¡d
::
¡ršg
 
´ÙocŞ
, 
Add»ss
 
add»ss
)

32 
	gm_çùÜy
.
S‘Ty³Id
 ("ns3::DashServer");

33 
	gm_çùÜy
.
S‘
 ("PrÙocŞ", 
SŒšgV®ue
 (
´ÙocŞ
));

34 
	gm_çùÜy
.
S‘
 ("Loÿl", 
Add»ssV®ue
 (
add»ss
));

38 
	gDashS”v”H–³r
::
S‘A‰ribu‹
 (
¡d
::
¡ršg
 
Çme
, cÚ¡ 
A‰ribu‹V®ue
 &
v®ue
)

40 
	gm_çùÜy
.
S‘
 (
Çme
, 
v®ue
);

43 
AµliÿtiÚCÚš”


44 
	gDashS”v”H–³r
::
In¡®l
 (
PŒ
<
Node
> 
node
) const

46  
AµliÿtiÚCÚš”
 (
In¡®lPriv
 (
node
));

49 
AµliÿtiÚCÚš”


50 
	gDashS”v”H–³r
::
In¡®l
 (
¡d
::
¡ršg
 
nodeName
) const

52 
PŒ
<
Node
> 
node
 = 
Names
::
Fšd
<Node> (
nodeName
);

53  
AµliÿtiÚCÚš”
 (
In¡®lPriv
 (
node
));

56 
AµliÿtiÚCÚš”


57 
	gDashS”v”H–³r
::
In¡®l
 (
NodeCÚš”
 
c
) const

59 
AµliÿtiÚCÚš”
 
­ps
;

60 
	gNodeCÚš”
::
I‹¿tÜ
 
i
 = 
c
.
Begš
 (); 
	gi
 !ğc.
End
 (); ++i)

62 
	g­ps
.
Add
 (
In¡®lPriv
 (*
i
));

65  
	g­ps
;

68 
	gPŒ
<
	gAµliÿtiÚ
>

69 
	gDashS”v”H–³r
::
In¡®lPriv
 (
PŒ
<
Node
> 
node
) const

71 
PŒ
<
AµliÿtiÚ
> 
­p
 = 
m_çùÜy
.
C»©e
<Application> ();

72 
	gnode
->
AddAµliÿtiÚ
 (
­p
);

74  
	g­p
;

	@helper/dash-server-helper.h

22 #iâdeà
DASH_SERVER_HELPER_H


23 
	#DASH_SERVER_HELPER_H


	)

25 
	~"ns3/objeù-çùÜy.h
"

26 
	~"ns3/v4-add»ss.h
"

27 
	~"ns3/node-cÚš”.h
"

28 
	~"ns3/­¶iÿtiÚ-cÚš”.h
"

30 
Çme¥aû
 
	gns3
 {

36 şas 
	cDashS”v”H–³r


38 
	gpublic
:

49 
DashS”v”H–³r
 (
¡d
::
¡ršg
 
´ÙocŞ
, 
Add»ss
 
add»ss
);

57 
S‘A‰ribu‹
 (
¡d
::
¡ršg
 
Çme
, cÚ¡ 
A‰ribu‹V®ue
 &
v®ue
);

66 
AµliÿtiÚCÚš”
 
In¡®l
 (
NodeCÚš”
 
c
) const;

74 
AµliÿtiÚCÚš”
 
In¡®l
 (
PŒ
<
Node
> 
node
) const;

82 
AµliÿtiÚCÚš”
 
In¡®l
 (
¡d
::
¡ršg
 
nodeName
) const;

84 
	g´iv©e
:

88 
PŒ
<
AµliÿtiÚ
> 
In¡®lPriv
 (PŒ<
Node
> 
node
) const;

89 
ObjeùFaùÜy
 
	gm_çùÜy
;

	@model/algorithms/aaash-client.cc

8 
	~"¯ash-ş›Á.h
"

9 
	~<ns3/log.h
>

10 
	~<ns3/simuÏtÜ.h
>

11 
	~<ns3/dash-ş›Á.h
>

13 
NS_LOG_COMPONENT_DEFINE
("AaashClient");

15 
Çme¥aû
 
	gns3


17 
NS_OBJECT_ENSURE_REGISTERED
(
A¯shCl›Á
);

19 
Ty³Id


20 
	gA¯shCl›Á
::
G‘Ty³Id
()

22 
Ty³Id
 
tid
 =

23 
Ty³Id
("ns3::A¯shCl›Á").
S‘P¬’t
<
DashCl›Á
>().
AddCÚ¡ruùÜ
<

24 
A¯shCl›Á
>();

25  
	gtid
;

28 
	gA¯shCl›Á
::
A¯shCl›Á
() :

29 
m_ruÂšg_ç¡_¡¬t
(
Œue
)

35 
A¯shCl›Á
::~AaashClient()

41 
A¯shCl›Á
::
C®cNextSegm’t
(
ušt32_t
 
cu¼R©e
, ušt32_ˆ& 
ÃxtR©e
,

42 
Time
 & 
d–ay
)

44 
ušt32_t
 
	g¿‹s
[] =

51 
ušt32_t
 
	g¿‹s_size
 = (
¿‹s
) / (rates[0]);

53 
	ga1
 = 0.75;

54 
	ga2
 = 0.33;

55 
	ga3
 = 0.5;

56 
	ga4
 = 0.75;

57 
	ga5
 = 0.9;

59 
Time
 
b_mš
("10s");

60 
Time
 
b_low
("20s");

61 
Time
 
b_high
("50s");

62 
Time
 
	gb_İt
 = 
SecÚds
((
b_low
 + 
b_high
).
G‘SecÚds
() * 0.5);

64 
Time
 
f
(
MliSecÚds
(
MPEG_FRAMES_PER_SEGMENT
 * 
MPEG_TIME_BETWEEN_FRAMES
));

66 
Time
 
	gb_t
 = 
m_bufãrS‹
.
rbegš
()->
£cÚd
;

69 
ušt32_t
 
	g¿‹Ind
 = 
¿‹s_size
;

70 
ušt32_t
 
	gi
 = 0; i < 
	g¿‹s_size
; i++)

72 ià(
	g¿‹s
[
i
] =ğ
cu¼R©e
)

74 
¿‹Ind
 = 
i
;

78 ià(
	g¿‹Ind
 =ğ
¿‹s_size
)

80 
NS_FATAL_ERROR
("Wrong„ate");

83 
	gÃxtR©e
 = 
cu¼R©e
;

84 
	gd–ay
 = 
SecÚds
(0);

86 
ušt32_t
 
	gr_up
 = 
¿‹s
[
¿‹Ind
];

87 
ušt32_t
 
	gr_down
 = 
¿‹s
[
¿‹Ind
];

88 ià(
	g¿‹Ind
 + 1 < 
	g¿‹s_size
)

90 
	gr_up
 = 
¿‹s
[
¿‹Ind
 + 1];

92 ià(
	g¿‹Ind
 >= 1)

94 
r_down
 = 
¿‹s
[
¿‹Ind
 - 1];

99 ià(
	gm_ruÂšg_ç¡_¡¬t
 && (
	g¿‹Ind
 !ğ
¿‹s_size
 - 1è&& 
BufãrInc
()

100 && (
cu¼R©e
 <ğ
a1
 * 
m_b™¿‹E¡im©e
))

102 ià(
b_t
 < 
b_mš
)

104 ià(
r_up
 <ğ
a2
 * 
m_b™¿‹E¡im©e
)

106 
ÃxtR©e
 = 
r_up
;

109 ià(
	gb_t
 < 
	gb_low
)

111 ià(
	gr_up
 <ğ
a3
 * 
m_b™¿‹E¡im©e
)

113 
ÃxtR©e
 = 
r_up
;

118 ià(
	gr_up
 <ğ
a4
 * 
m_b™¿‹E¡im©e
)

120 
ÃxtR©e
 = 
r_up
;

122 ià(
	gb_t
 > 
	gb_high
)

124 
	gd–ay
 = 
b_high
 - 
f
;

130 
	gm_ruÂšg_ç¡_¡¬t
 = 
çl£
;

131 ià(
	gb_t
 < 
	gb_mš
)

133 
	gÃxtR©e
 = 
¿‹s
[0];

135 ià(
	gb_t
 < 
	gb_low
)

137 ià(
	gcu¼R©e
 !ğ
¿‹s
[0] && 
cu¼R©e
 >ğ
m_b™¿‹E¡im©e
)

139 
ÃxtR©e
 = 
r_down
;

142 ià(
	gb_t
 < 
	gb_high
)

144 ià((
	gcu¼R©e
 =ğ
¿‹s
[
¿‹s_size
 - 1])

145 || (
r_up
 >ğ
a5
 * 
m_b™¿‹E¡im©e
))

147 
d–ay
 = 
¡d
::
max
(
b_t
 - 
f
, 
b_İt
);

152 ià((
	gcu¼R©e
 =ğ
¿‹s
[
¿‹s_size
 - 1])

153 || (
r_up
 >ğ
a5
 * 
m_b™¿‹E¡im©e
))

155 
d–ay
 = 
¡d
::
max
(
b_t
 - 
f
, 
b_İt
);

159 
	gÃxtR©e
 = 
r_up
;

165 
NS_LOG_INFO
(

166 "ÃxtR©e: " << 
ÃxtR©e
 << "\tb_d–ay: " << 
d–ay
.
G‘SecÚds
(è<< "\tb_t: " << 
b_t
.G‘SecÚds(è<< "\tb_İt: " << 
b_İt
.GetSeconds());

169 
boŞ


170 
	gA¯shCl›Á
::
BufãrInc
()

172 
Time
 
Ï¡
(
SecÚds
(0));

174 
	g¡d
::
m­
<
Time
, 
	gTime
>::
™”©Ü
 
™
 = 
m_bufãrS‹
.
begš
();

175 
	g™
 !ğ
m_bufãrS‹
.
’d
(); it++)

180 ià(
	g™
->
	g£cÚd
 < 
	gÏ¡
)

182  
	gçl£
;

184 
	gÏ¡
 = 
™
->
£cÚd
;

186  
	gŒue
;

	@model/algorithms/aaash-client.h

8 #iâdeà
AAASH_CLIENT_H_


9 
	#AAASH_CLIENT_H_


	)

11 
	~<ns3/dash-ş›Á.h
>

12 
Çme¥aû
 
	gns3


15 şas 
	cA¯shCl›Á
 : 
public
 
DashCl›Á


17 
public
:

18 
Ty³Id


19 
G‘Ty³Id
();

21 
A¯shCl›Á
();

23 
	gvœtu®


24 ~
A¯shCl›Á
();

26 
vœtu®
 

27 
C®cNextSegm’t
(
ušt32_t
 
cu¼R©e
, ušt32_ˆ& 
ÃxtR©e
, 
Time
 & 
d–ay
);

29 
	g´iv©e
:

30 
boŞ


31 
BufãrInc
();

33 
boŞ
 
	gm_ruÂšg_ç¡_¡¬t
;

	@model/algorithms/fdash-client.cc

8 
	~"fdash-ş›Á.h
"

9 
	~<ns3/log.h
>

10 
	~<ns3/simuÏtÜ.h
>

11 
	~<ns3/dash-ş›Á.h
>

13 
NS_LOG_COMPONENT_DEFINE
("FdashClient");

15 
Çme¥aû
 
	gns3


17 
NS_OBJECT_ENSURE_REGISTERED
(
FdashCl›Á
);

19 
Ty³Id


20 
	gFdashCl›Á
::
G‘Ty³Id
()

22 
Ty³Id
 
tid
 =

23 
Ty³Id
("ns3::FdashCl›Á").
S‘P¬’t
<
DashCl›Á
>().
AddCÚ¡ruùÜ
<

24 
FdashCl›Á
>();

25  
	gtid
;

28 
	gFdashCl›Á
::
FdashCl›Á
()

34 
FdashCl›Á
::~FdashClient()

40 
FdashCl›Á
::
C®cNextSegm’t
(
ušt32_t
 
cu¼R©e
, ušt32_ˆ& 
ÃxtR©e
,

41 
Time
 & 
d–ay
)

43 
	g¦ow
 = 0, 
	gok
 = 0, 
	gç¡
 = 0, 
	gçÎšg
 = 0, 
	g¡—dy
 = 0, 
	grisšg
 = 0, 
	gr1
 =

44 0, 
	gr2
 = 0, 
	gr3
 = 0, 
	gr4
 = 0, 
	gr5
 = 0, 
	gr6
 = 0, 
	gr7
 = 0, 
	gr8
 = 0, 
	gr9
 = 0, 
	gp2
 =

45 0, 
	gp1
 = 0, 
	gz
 = 0, 
	gn1
 = 0, 
	gn2
 = 0, 
	gouut
 = 0;

47 
	gt
 = 
m_rg‘_dt
.
G‘SecÚds
();

49 
	gcu¼Dt
 = 
G‘BufãrE¡im©e
();

50 
	gdiff
 = 
G‘BufãrDifã»ÁŸl
();

52 ià(
	gcu¼Dt
 < 2 * 
	gt
 / 3)

54 
	g¦ow
 = 1.0;

56 ià(
	gcu¼Dt
 < 
	gt
)

58 
	g¦ow
 = 1 - 1 / (
t
 / 3è* (
cu¼Dt
 - 2 * / 3);

59 
	gok
 = 1 / (
t
 / 3è* (
cu¼Dt
 - 2 * / 3);

61 ià(
	gcu¼Dt
 < 4 * 
	gt
)

63 
	gok
 = 1 - 1 / (3 * 
t
è* (
cu¼Dt
 -);

64 
	gç¡
 = 1 / (3 * 
t
è* (
cu¼Dt
 -);

68 
	gç¡
 = 1;

71 ià(
	gdiff
 < -2 * 
	gt
 / 3)

73 
	gçÎšg
 = 1;

75 ià(
	gdiff
 < 0)

77 
	gçÎšg
 = 1 - 1 / (2 * 
t
 / 3è* (
diff
 + 2 * / 3);

78 
	g¡—dy
 = 1 / (2 * 
t
 / 3è* (
diff
 + 2 * / 3);

80 ià(
	gdiff
 < 4 * 
	gt
)

82 
	g¡—dy
 = 1 - 1 / (4 * 
t
è* 
diff
;

83 
	grisšg
 = 1 / (4 * 
t
è* 
diff
;

87 
	grisšg
 = 1;

90 
	gr1
 = 
¡d
::
mš
(
¦ow
, 
çÎšg
);

91 
	gr2
 = 
¡d
::
mš
(
ok
, 
çÎšg
);

92 
	gr3
 = 
¡d
::
mš
(
ç¡
, 
çÎšg
);

93 
	gr4
 = 
¡d
::
mš
(
¦ow
, 
¡—dy
);

94 
	gr5
 = 
¡d
::
mš
(
ok
, 
¡—dy
);

95 
	gr6
 = 
¡d
::
mš
(
ç¡
, 
¡—dy
);

96 
	gr7
 = 
¡d
::
mš
(
¦ow
, 
risšg
);

97 
	gr8
 = 
¡d
::
mš
(
ok
, 
risšg
);

98 
	gr9
 = 
¡d
::
mš
(
ç¡
, 
risšg
);

100 
	gp2
 = 
¡d
::
sq¹
(¡d::
pow
(
r9
, 2));

101 
	gp1
 = 
¡d
::
sq¹
(¡d::
pow
(
r6
, 2è+ std::pow(
r8
, 2));

102 
	gz
 = 
¡d
::
sq¹
(¡d::
pow
(
r3
, 2è+ std::pow(
r5
, 2è+ std::pow(
r7
, 2));

103 
	gn1
 = 
¡d
::
sq¹
(¡d::
pow
(
r2
, 2è+ std::pow(
r4
, 2));

104 
	gn2
 = 
¡d
::
sq¹
(¡d::
pow
(
r1
, 2));

107 
	gouut
 = (
n2
 * 0.25 + 
n1
 * 0.5 + 
z
 * 1 + 
p1
 * 2 + 
p2
 * 4)

108 / (
n2
 + 
n1
 + 
z
 + 
p1
 + 
p2
);

110 
NS_LOG_INFO
(

111 "cu¼Dt: " << 
cu¼Dt
 << " diff: " << 
diff
 << " slow: " << 
¦ow
 << " ok: " << 
ok
 << " fa¡: " << 
ç¡
 << " f®lšg: " << 
çÎšg
 << " s‹ady: " << 
¡—dy
 << "„isšg: " << 
risšg
 << "„1: " << 
r1
 << "„2: " << 
r2
 << "„3: " << 
r3
 << "„4: " << 
r4
 << "„5: " << 
r5
 << "„6: " << 
r6
 << "„7: " << 
r7
 << "„8: " << 
r8
 << "„9: " << 
r9
 << "…2: " << 
p2
 << "…1: " << 
p1
 << " z: " << 
z
 << "‚1: " << 
n1
 << "‚2: " << 
n2
 << " ouut: " << 
ouut
);

113 
ušt32_t
 
	g»suÉ
 = 0;

115 
	g»suÉ
 = 
ouut
 * 
m_b™¿‹E¡im©e
;

117 
ušt32_t
 
	g¿‹s
[] =

124 
ušt32_t
 
	g¿‹s_size
 = (
¿‹s
) / (rates[0]);

126 
ušt32_t
 
	gi
;

128 
	gÃxtR©e
 = 
¿‹s
[0];

130 
	gi
 = 0; i < 
	g¿‹s_size
; i++)

132 ià(
	g»suÉ
 > 
	g¿‹s
[
i
])

134 
	gÃxtR©e
 = 
¿‹s
[
i
];

138 
	gd–ay
 = 
SecÚds
(0);

139 ià(
	gÃxtR©e
 > 
	gcu¼R©e
)

153 
	gt_60
 = 
cu¼Dt
 + (
m_b™¿‹E¡im©e
 / 
ÃxtR©e
 - 1) * 60;

155 ià(
	gt_60
 < 
	gt
)

157 
	gÃxtR©e
 = 
cu¼R©e
;

158 
	gt_60
 = 
cu¼Dt
 + (
m_b™¿‹E¡im©e
 / 
ÃxtR©e
 - 1) * 60;

160 ià(
	gt_60
 > 
	gt
)

167 ià(
	gÃxtR©e
 < 
	gcu¼R©e
)

169 
	gt_60
 = 
cu¼Dt
 + (
m_b™¿‹E¡im©e
 / 
ÃxtR©e
 - 1) * 60;

171 ià(
	gt_60
 > 
	gt
)

173 
	gt_60
 = 
cu¼Dt
 + (
m_b™¿‹E¡im©e
 / 
cu¼R©e
 - 1) * 60;

174 ià(
	gt_60
 > 
	gt
)

176 
	gÃxtR©e
 = 
cu¼R©e
;

182 
NS_LOG_INFO
(
cu¼R©e
 << " " << 
ouut
 << " " << 
»suÉ
);

	@model/algorithms/fdash-client.h

8 #iâdeà
FDASH_CLIENT_H_


9 
	#FDASH_CLIENT_H_


	)

11 
	~<ns3/dash-ş›Á.h
>

12 
Çme¥aû
 
	gns3


15 şas 
	cFdashCl›Á
 : 
public
 
DashCl›Á


17 
public
:

18 
Ty³Id


19 
G‘Ty³Id
();

21 
FdashCl›Á
();

23 
	gvœtu®


24 ~
FdashCl›Á
();

26 
vœtu®
 

27 
C®cNextSegm’t
(
ušt32_t
 
cu¼R©e
, ušt32_ˆ& 
ÃxtR©e
, 
Time
 & 
d–ay
);

29 
	g´iv©e
:

30 
boŞ


31 
BufãrInc
();

	@model/algorithms/osmp-client.cc

8 
	~"osmp-ş›Á.h
"

9 
	~<ns3/log.h
>

10 
	~<ns3/simuÏtÜ.h
>

11 
	~<ns3/dash-ş›Á.h
>

13 
NS_LOG_COMPONENT_DEFINE
("OsmpClient");

15 
Çme¥aû
 
	gns3


17 
NS_OBJECT_ENSURE_REGISTERED
(
OsmpCl›Á
);

19 
Ty³Id


20 
	gOsmpCl›Á
::
G‘Ty³Id
()

22 
Ty³Id
 
tid
 =

23 
Ty³Id
("ns3::OsmpCl›Á").
S‘P¬’t
<
DashCl›Á
>().
AddCÚ¡ruùÜ
<

24 
OsmpCl›Á
>();

25  
	gtid
;

28 
	gOsmpCl›Á
::
OsmpCl›Á
()

34 
OsmpCl›Á
::~OsmpClient()

40 
OsmpCl›Á
::
C®cNextSegm’t
(
ušt32_t
 
cu¼R©e
, ušt32_ˆ& 
ÃxtR©e
,

41 
Time
 & 
d–ay
)

43 
ušt32_t
 
	g¿‹s
[] =

48 
ušt32_t
 
	g¿‹s_size
 = (
¿‹s
) / (rates[0]);

50 
	g¡d
::
m­
<
Time
, 
	gTime
>::
™”©Ü
 
™
;

51 
	g™
 = 
m_bufãrS‹
.
’d
();

53 
	g™
--;

54 
Time
 
	gnow
 = 
™
->
fœ¡
;

56 ià(
	g™
 !ğ
m_bufãrS‹
.
begš
())

58 
™
--;

62 
Time
 
	gt_Ï¡_äag
 = 
now
 - 
™
->
fœ¡
;

65 
	gl_cur
 = 0;

66 
	g¿‹s
[
l_cur
] !ğ
cu¼R©e
)

68 
l_cur
++;

71 
	gl_nxt
 = 0;

72 
	gl_mš
 = 0;

73 
	gl_max
 = 
¿‹s_size
 - 1;

75 
	gr_dowÆßd
 = 100;

76 ià(
	gt_Ï¡_äag
.
G‘MliSecÚds
() > 0)

78 
	gr_dowÆßd
 = (1.0 * 
MPEG_FRAMES_PER_SEGMENT
 * 
MPEG_TIME_BETWEEN_FRAMES
)

79 / 
t_Ï¡_äag
.
G‘MliSecÚds
();

85 ià(
	gr_dowÆßd
 < 1)

87 ià(
	gl_cur
 > 
	gl_mš
)

89 ià(
	gr_dowÆßd
 < ((1.0 * 
	g¿‹s
[
l_cur
 - 1]) /„ates[l_cur]))

91 
	gl_nxt
 = 
l_mš
;

95 
	gl_nxt
 = 
l_cur
 - 1;

101 ià(
	gl_cur
 < 
	gl_max
)

103 ià(
	gl_cur
 == 0

104 || 
r_dowÆßd
 > ((1.0 * 
¿‹s
[
l_cur
 - 1]) /„ates[l_cur]))

108 
l_nxt
 =†_nxt + 1;

110 !(
	gl_nxt
 =ğ
l_max


111 || 
r_dowÆßd
 < ((1.0 * 
¿‹s
[
l_nxt
 + 1]è/„©es[
l_cur
])));

117 
	gd–ay
 = 
SecÚds
(0);

118 
	gÃxtR©e
 = 
¿‹s
[
l_nxt
];

	@model/algorithms/osmp-client.h

8 #iâdeà
OSMP_CLIENT_H_


9 
	#OSMP_CLIENT_H_


	)

11 
	~<ns3/dash-ş›Á.h
>

12 
Çme¥aû
 
	gns3


15 şas 
	cOsmpCl›Á
 : 
public
 
DashCl›Á


17 
public
:

18 
Ty³Id


19 
G‘Ty³Id
();

21 
OsmpCl›Á
();

23 
	gvœtu®


24 ~
OsmpCl›Á
();

26 
vœtu®
 

27 
C®cNextSegm’t
(
ušt32_t
 
cu¼R©e
, ušt32_ˆ& 
ÃxtR©e
, 
Time
 & 
d–ay
);

	@model/algorithms/raahs-client.cc

8 
	~"¿ahs-ş›Á.h
"

9 
	~<ns3/log.h
>

10 
	~<ns3/simuÏtÜ.h
>

11 
	~<ns3/dash-ş›Á.h
>

13 
NS_LOG_COMPONENT_DEFINE
("RaahsClient");

15 
Çme¥aû
 
	gns3


17 
NS_OBJECT_ENSURE_REGISTERED
(
R¯hsCl›Á
);

19 
Ty³Id


20 
	gR¯hsCl›Á
::
G‘Ty³Id
()

22 
Ty³Id
 
tid
 =

23 
Ty³Id
("ns3::R¯hsCl›Á").
S‘P¬’t
<
DashCl›Á
>().
AddCÚ¡ruùÜ
<

24 
R¯hsCl›Á
>();

25  
	gtid
;

28 
	gR¯hsCl›Á
::
R¯hsCl›Á
()

34 
R¯hsCl›Á
::~RaahsClient()

40 
R¯hsCl›Á
::
C®cNextSegm’t
(
ušt32_t
 
cu¼R©e
, ušt32_ˆ& 
ÃxtR©e
,

41 
Time
 & 
d–ay
)

43 
ušt32_t
 
	g¿‹s
[] =

50 
ušt32_t
 
	g¿‹s_size
 = (
¿‹s
) / (rates[0]);

53 
	gmsd
 = 
MPEG_FRAMES_PER_SEGMENT
 * 
MPEG_TIME_BETWEEN_FRAMES
 / 1000.0;

54 
	gsá
 = 
G‘Segm’tF‘chTime
();

56 
	gmi
 = 
msd
 / 
sá
;

58 
	gt_mš
 = 9;

60 
	g•sÚ
 = 0.0;

61 
ušt32_t
 
	gi
;

62 
	gi
 = 0; i < 
	g¿‹s_size
 - 1; i++)

64 
	g•sÚ
 = 
¡d
::
max
(
•sÚ
, (1.0 * 
¿‹s
[
i
 + 1] -„ates[i]) /„ates[i]);

67 
	ggamma_d
 = 0.67;

69 
	g¿‹Ind
 = 
¿‹s_size
;

70 
ušt32_t
 
	gi
 = 0; i < 
	g¿‹s_size
; i++)

72 ià(
	g¿‹s
[
i
] =ğ
cu¼R©e
)

74 
¿‹Ind
 = 
i
;

78 ià(
	g¿‹Ind
 =ğ
¿‹s_size
)

80 
NS_FATAL_ERROR
("Wrong„ate");

83 ià(
	gmi
 > 1 + 
	g•sÚ
)

85 ià(
	g¿‹Ind
 < 
	g¿‹s_size
 - 1)

87 
	gÃxtR©e
 = 
¿‹s
[()
¿‹Ind
 + 1];

90 ià(
	gmi
 < 
	ggamma_d
)

92 
	gi
 = 
¿‹Ind
 - 1;

93 
	gi
 = 0; i < 
	g¿‹Ind
 - 1; i--)

95 ià(
	g¿‹s
[
i
] < 
mi
 * 
	gcu¼R©e
)

97 
	gÃxtR©e
 = 
¿‹s
[
i
];

107 
	gts
 = 
G‘BufãrE¡im©e
(è- 
t_mš
 - 
cu¼R©e
 * 
msd
 / 
¿‹s
[0];

109 ià(
	gts
 > 0)

111 
	gd–ay
 = 
SecÚds
(
ts
);

115 
	gd–ay
 = 
SecÚds
(0);

	@model/algorithms/raahs-client.h

8 #iâdeà
RAAHS_CLIENT_H_


9 
	#RAAHS_CLIENT_H_


	)

11 
	~<ns3/dash-ş›Á.h
>

12 
Çme¥aû
 
	gns3


15 şas 
	cR¯hsCl›Á
 : 
public
 
DashCl›Á


17 
public
:

18 
Ty³Id


19 
G‘Ty³Id
();

21 
R¯hsCl›Á
();

23 
	gvœtu®


24 ~
R¯hsCl›Á
();

26 
vœtu®
 

27 
C®cNextSegm’t
(
ušt32_t
 
cu¼R©e
, ušt32_ˆ& 
ÃxtR©e
, 
Time
 & 
d–ay
);

29 
	g´iv©e
:

	@model/algorithms/sftm-client.cc

8 
	~"sám-ş›Á.h
"

9 
	~<ns3/log.h
>

10 
	~<ns3/simuÏtÜ.h
>

11 
	~<ns3/dash-ş›Á.h
>

13 
NS_LOG_COMPONENT_DEFINE
("SftmClient");

15 
Çme¥aû
 
	gns3


17 
NS_OBJECT_ENSURE_REGISTERED
(
SámCl›Á
);

19 
Ty³Id


20 
	gSámCl›Á
::
G‘Ty³Id
()

22 
Ty³Id
 
tid
 =

23 
Ty³Id
("ns3::SámCl›Á").
S‘P¬’t
<
DashCl›Á
>().
AddCÚ¡ruùÜ
<

24 
SámCl›Á
>();

25  
	gtid
;

28 
	gSámCl›Á
::
SámCl›Á
() :

29 
m_rsá_exûeded
(
çl£
)

35 
SámCl›Á
::~SftmClient()

41 
SámCl›Á
::
C®cNextSegm’t
(
ušt32_t
 
cu¼R©e
, ušt32_ˆ& 
ÃxtR©e
,

42 
Time
 & 
d–ay
)

44 
ušt32_t
 
	g¿‹s
[] =

51 
ušt32_t
 
	g¿‹s_size
 = (
¿‹s
) / (rates[0]);

54 
	gmsd
 = 
MPEG_FRAMES_PER_SEGMENT
 * 
MPEG_TIME_BETWEEN_FRAMES
 / 1000.0;

55 
	gsá
 = 
G‘Segm’tF‘chTime
();

56 
	gtbmt
 = 
m_rg‘_dt
.
G‘SecÚds
();

57 
	gts_ns
 = 
m_£gm’tId
 * 
msd
;

58 
	gts_o
 = 
G‘PÏy”
().
m_äamesPÏyed
 * 
MPEG_TIME_BETWEEN_FRAMES


60 
	grsá
 = 
ts_ns
 - 
ts_o
 - 
tbmt
;

61 
	grho
 = 0.75;

63 
	grsá_s
 = 
rho
 * 
msd
;

64 ià(
	grsá
 < 
	grsá_s
 && !
	gm_rsá_exûeded
)

66 
	grsá
 = 
rsá_s
;

70 
	gm_rsá_exûeded
 = 
Œue
;

73 
	gsám
 = 
¡d
::
mš
(
msd
, 
rsá
è/ 
	gsá
;

75 
ušt32_t
 
	g¿‹Ind
 = 
¿‹s_size
;

76 
ušt32_t
 
	gi
 = 0; i < 
	g¿‹s_size
; i++)

78 ià(
	g¿‹s
[
i
] =ğ
cu¼R©e
)

80 
¿‹Ind
 = 
i
;

84 ià(
	g¿‹Ind
 =ğ
¿‹s_size
)

86 
NS_FATAL_ERROR
("Wrong„ate");

89 
	gec_u
 =

90 
¿‹Ind
 < 
¿‹s_size
 - 1 ?

91 (1.0 * 
¿‹s
[
¿‹Ind
 + 1] -„ates[rateInd]) /„ates[rateInd] :

92 
¡d
::
num”ic_lim™s
<>::
max
();

94 
	gemax_u
 = 0;

95 
ušt32_t
 
	gi
 = 0; i < 
	g¿‹s_size
 - 1; i++)

97 
	ge
 = (1.0 * 
¿‹s
[
i
 + 1] -„ates[i]) /„ates[i];

98 
	gemax_u
 = 
¡d
::
max
(
emax_u
, 
e
);

101 
	ge_u
 = 
¡d
::
mš
(
emax_u
, 2 * 
ec_u
);

103 
	gec_d
 =

104 
¿‹Ind
 > 0 ?

105 (1.0 * 
¿‹s
[
¿‹Ind
] -„ates[rateInd - 1]) /„ates[rateInd] : 1.0;

107 
	gemš_d
 = 
¡d
::
num”ic_lim™s
<>::
max
();

108 
ušt32_t
 
	gi
 = 1; i < 
	g¿‹s_size
; i++)

110 
	ge
 = (1.0 * 
¿‹s
[
i
] -„ates[i - 1]) /„ates[i];

111 
	gemš_d
 = 
¡d
::
mš
(
emš_d
, 
e
);

114 
	ge_d
 = 
¡d
::
max
(2 * 
emš_d
, 
ec_d
);

116 ià(
	gsám
 > 1 + 
	ge_u
 && 
	g¿‹Ind
 < 
	g¿‹s_size
 - 1)

118 
	gÃxtR©e
 = 
¿‹s
[
¿‹Ind
 + 1];

120 ià(
	gsám
 < 1 - 
	ge_d
 && 
	g¿‹Ind
 != 0)

122 
ušt32_t
 
i
 = 0; 
	gi
 < 
	g¿‹Ind
; i++)

124 ià(
	g¿‹s
[
i
] >ğ
sám
 * 
¿‹s
[
¿‹Ind
])

128 
	gÃxtR©e
 = 
¿‹s
[
i
];

132 
	gbmt_mš
 = 0;

133 
	gbmt_c
 = 
G‘BufãrE¡im©e
();

134 
	gb_max
 = 
¿‹s
[
¿‹s_size
 - 1];

135 
	gb_mš
 = 
¿‹s
[0];

136 
	gt_id
 = 
bmt_c
 - 
bmt_mš
 - 
msd
 * 
b_max
 / 
b_mš
;

138 ià(
	gt_id
 > 0)

140 
	gd–ay
 = 
SecÚds
(
t_id
);

144 
	gd–ay
 = 
SecÚds
(0);

	@model/algorithms/sftm-client.h

8 #iâdeà
SFTM_CLIENT_H_


9 
	#SFTM_CLIENT_H_


	)

11 
	~<ns3/dash-ş›Á.h
>

12 
Çme¥aû
 
	gns3


15 şas 
	cSámCl›Á
 : 
public
 
DashCl›Á


17 
public
:

18 
Ty³Id


19 
G‘Ty³Id
();

21 
SámCl›Á
();

23 
	gvœtu®


24 ~
SámCl›Á
();

26 
vœtu®
 

27 
C®cNextSegm’t
(
ušt32_t
 
cu¼R©e
, ušt32_ˆ& 
ÃxtR©e
, 
Time
 & 
d–ay
);

29 
	g´iv©e
:

30 
boŞ
 
m_rsá_exûeded
;

	@model/algorithms/svaa-client.cc

8 
	~"sv¯-ş›Á.h
"

9 
	~<ns3/log.h
>

10 
	~<ns3/simuÏtÜ.h
>

11 
	~<ns3/dash-ş›Á.h
>

13 
NS_LOG_COMPONENT_DEFINE
("SvaaClient");

15 
Çme¥aû
 
	gns3


17 
NS_OBJECT_ENSURE_REGISTERED
(
Sv¯Cl›Á
);

19 
Ty³Id


20 
	gSv¯Cl›Á
::
G‘Ty³Id
()

22 
Ty³Id
 
tid
 =

23 
Ty³Id
("ns3::Sv¯Cl›Á").
S‘P¬’t
<
DashCl›Á
>().
AddCÚ¡ruùÜ
<

24 
Sv¯Cl›Á
>();

25  
	gtid
;

28 
	gSv¯Cl›Á
::
Sv¯Cl›Á
() :

29 
m_m_k_1
(0), 
m_m_k_2
(0), 
m_couÁ”
(0)

35 
	gSv¯Cl›Á
::~
Sv¯Cl›Á
()

41 
Sv¯Cl›Á
::
C®cNextSegm’t
(
ušt32_t
 
cu¼R©e
, ušt32_ˆ& 
ÃxtR©e
,

42 
Time
 & 
d–ay
)

44 
ušt32_t
 
	g¿‹s
[] =

49 
ušt32_t
 
	g¿‹s_size
 = (
¿‹s
) / (rates[0]);

50 
	gdiff
 = 
G‘BufãrDifã»ÁŸl
();

52 
	gq_tk
 = 
G‘BufãrE¡im©e
();

53 
	gq_»f
 = 
m_rg‘_dt
.
G‘SecÚds
();

54 
	gp
 = 1.0;

55 
	gf_q
 = 2 * 
¡d
::
exp
(
p
 * (
q_tk
 - 
q_»f
))

56 / (1 + 
¡d
::
exp
(
p
 * (
q_tk
 - 
q_»f
)));

57 
	gd–
 = 
MPEG_TIME_BETWEEN_FRAMES
 * 
MPEG_FRAMES_PER_SEGMENT
 / 1000.0;

58 
	gf_t
 = 
d–
 / (d– - 
diff
);

59 
	gf_u
 = 1;

61 
	gf
 = 
f_q
 * 
f_t
 * 
f_u
;

63 
	gt_k
 = 
m_b™¿‹E¡im©e
;

65 
	gu_k
 = 
f
 * 
t_k
;

67 
	gm_k
 = 0;

68 ià(
	gdiff
 >ğ0.4 * 
d–
)

70 
m_k
 = 1;

72 ià(
	gdiff
 >ğ0.2 * 
d–
)

74 
m_k
 = 5;

76 ià(
	gdiff
 >= 0)

78 
m_k
 = 15;

82 
	gm_k
 = 20;

85 
	gm
 = (
m_k
 + 
m_m_k_1
 + 
m_m_k_2
) / 3;

86 
	gm_m_k_2
 = 
m_m_k_1
;

87 
	gm_m_k_1
 = 
m_k
;

89 ià(
	gq_tk
 < 
	gq_»f
 / 2)

91 
	gi
 = 
¿‹s_size
 - 1;

92 
	g¿‹s
[
i
] > 
	gt_k
 && 
	gi
 > 0)

94 
	gi
--;

96 
	gÃxtR©e
 = 
¿‹s
[
i
];

97 
	gd–ay
 = 
SecÚds
(0);

100 ià(
	gu_k
 > 
	gcu¼R©e
)

102 
	gm_couÁ”
++;

103 ià(
	gm_couÁ”
 > 
	gm
)

105 
	gi
 = 
¿‹s_size
 - 1;

106 
	g¿‹s
[
i
] > 
	gt_k
 && 
	gi
 > 0)

108 
	gi
--;

110 
	gÃxtR©e
 = 
¿‹s
[
i
];

111 
	gd–ay
 = 
SecÚds
(0);

112 
	gm_couÁ”
 = 0;

116 ià(
	gu_k
 < 
	gcu¼R©e
)

118 
	gm_couÁ”
 = 0;

120 
	gÃxtR©e
 = 
cu¼R©e
;

121 
	gd–ay
 = 
SecÚds
(0);

	@model/algorithms/svaa-client.h

8 #iâdeà
SVAA_CLIENT_H_


9 
	#SVAA_CLIENT_H_


	)

11 
	~<ns3/dash-ş›Á.h
>

12 
Çme¥aû
 
	gns3


15 şas 
	cSv¯Cl›Á
 : 
public
 
DashCl›Á


17 
public
:

18 
Ty³Id


19 
G‘Ty³Id
();

21 
Sv¯Cl›Á
();

23 
	gvœtu®


24 ~
Sv¯Cl›Á
();

26 
vœtu®
 

27 
C®cNextSegm’t
(
ušt32_t
 
cu¼R©e
, ušt32_ˆ& 
ÃxtR©e
, 
Time
 & 
d–ay
);

29 
	g´iv©e
:

30 
m_m_k_1
;

31 
	gm_m_k_2
;

32 
	gm_couÁ”
;

	@model/dash-client.cc

21 
	~<ns3/log.h
>

22 
	~<ns3/uš‹g”.h
>

23 
	~<ns3/tı-sock‘-çùÜy.h
>

24 
	~<ns3/simuÏtÜ.h
>

25 
	~<ns3/š‘-sock‘-add»ss.h
>

26 
	~<ns3/š‘6-sock‘-add»ss.h
>

27 
	~"h‰p-h—d”.h
"

28 
	~"dash-ş›Á.h
"

29 
	~"·¿.h
"

31 
NS_LOG_COMPONENT_DEFINE
("DashClient");

32 
usšg
 
Çme¥aû
 
	g¡d
;

34 
	gveùÜ
 <> 
	gvideo_num
;

36 
Çme¥aû
 
	gns3


39 
NS_OBJECT_ENSURE_REGISTERED
(
DashCl›Á
);

41 
	gDashCl›Á
::
m_couÁObjs
 = 0;

43 
Ty³Id


44 
	gDashCl›Á
::
G‘Ty³Id
()

46 
Ty³Id
 
tid
 =

47 
Ty³Id
("ns3::DashCl›Á").
S‘P¬’t
<
AµliÿtiÚ
>().
AddCÚ¡ruùÜ
<

48 
DashCl›Á
>().
AddA‰ribu‹
("VideoId",

49 "ThId oàthvideØth© i ¶ayed.", 
Uš‹g”V®ue
(0),

50 
MakeUš‹g”AcûssÜ
(&
DashCl›Á
::
m_videoId
),

51 
MakeUš‹g”Check”
<
ušt32_t
>(1)).
AddA‰ribu‹
("Remote",

52 "Thadd»s oàthde¡š©iÚ", 
Add»ssV®ue
(),

53 
MakeAdd»ssAcûssÜ
(&
DashCl›Á
::
m_³”
), 
MakeAdd»ssCheck”
()).
AddA‰ribu‹
(

55 
Ty³IdV®ue
(
TıSock‘FaùÜy
::
G‘Ty³Id
()),

56 
MakeTy³IdAcûssÜ
(&
DashCl›Á
::
m_tid
), 
MakeTy³IdCheck”
()).
AddA‰ribu‹
(

57 "T¬g‘Dt", "Thrg‘ bufãršgime", 
TimeV®ue
(
Time
("35s")),

58 
MakeTimeAcûssÜ
(&
DashCl›Á
::
m_rg‘_dt
), 
MakeTimeCheck”
()).
AddA‰ribu‹
(

60 
TimeV®ue
(
Time
("10s")), 
MakeTimeAcûssÜ
(&
DashCl›Á
::
m_wšdow
),

61 
MakeTimeCheck”
()

63 ).
AddT¿ûSourû
("Tx", "A‚ew…acket is created‡nd is sent",

64 
MakeT¿ûSourûAcûssÜ
(&
DashCl›Á
::
m_txT¿û
));

65  
	gtid
;

68 
	gDashCl›Á
::
DashCl›Á
() :

69 
m_¿‹Chªges
(0), 
m_rg‘_dt
("35s"), 
m_b™¿‹E¡im©e
(0.0), 
m_£gm’tId
(

70 0), 
m_sock‘
(0), 
m_cÚÃùed
(
çl£
), 
m_tÙBy‹s
(0), 
m_¡¬‹dReûivšg
(

71 
SecÚds
(0)), 
m_sumDt
(SecÚds(0)), 
m_Ï¡Dt
(SecÚds(-1)), 
m_id
(

72 
m_couÁObjs
++), 
m_»que¡Time
("0s"), 
m_£gm’t_by‹s
(0), 
m_b™R©e
(

73 50000), 
m_wšdow
(
SecÚds
(10)), 
m_£gm’tF‘chTime
(Seconds(0))

75 
NS_LOG_FUNCTION
(
this
);

76 
	gm_·r£r
.
S‘Aµ
(
this
);

79 
	gDashCl›Á
::~
DashCl›Á
()

81 
NS_LOG_FUNCTION
(
this
);

84 
	gPŒ
<
	gSock‘
>

85 
	gDashCl›Á
::
G‘Sock‘
() const

87 
NS_LOG_FUNCTION
(
this
);

88  
	gm_sock‘
;

92 
	gDashCl›Á
::
DoDi¥o£
()

94 
NS_LOG_FUNCTION
(
this
);

96 
	gm_sock‘
 = 0;

98 
	gAµliÿtiÚ
::
DoDi¥o£
();

103 
	gDashCl›Á
::
S¹AµliÿtiÚ
()

105 
NS_LOG_FUNCTION
(
this
);

109 ià(!
	gm_sock‘
)

111 
	gm_sock‘
 = 
Sock‘
::
C»©eSock‘
(
G‘Node
(), 
m_tid
);

114 ià(
	gm_sock‘
->
G‘Sock‘Ty³
(è!ğ
Sock‘
::
NS3_SOCK_STREAM


115 && 
m_sock‘
->
G‘Sock‘Ty³
(è!ğ
Sock‘
::
NS3_SOCK_SEQPACKET
)

117 
NS_FATAL_ERROR
("Using HTTP with‡n incompatible socketype. "

122 ià(
	gIÃt6Sock‘Add»ss
::
IsM©chšgTy³
(
m_³”
))

124 
m_sock‘
->
Bšd6
();

126 ià(
	gIÃtSock‘Add»ss
::
IsM©chšgTy³
(
m_³”
))

128 
m_sock‘
->
Bšd
();

131 
	gm_sock‘
->
CÚÃù
(
m_³”
);

132 
	gm_sock‘
->
S‘RecvC®lback
(
MakeC®lback
(&
DashCl›Á
::
HªdËR—d
, 
this
));

133 
	gm_sock‘
->
S‘CÚÃùC®lback
(

134 
MakeC®lback
(&
DashCl›Á
::
CÚÃùiÚSucûeded
, 
this
),

135 
MakeC®lback
(&
DashCl›Á
::
CÚÃùiÚFaed
, 
this
));

136 
	gm_sock‘
->
S‘S’dC®lback
(
MakeC®lback
(&
DashCl›Á
::
D©aS’d
, 
this
));

141 
	gDashCl›Á
::
StİAµliÿtiÚ
()

143 
NS_LOG_FUNCTION
(
this
);

145 ià(
	gm_sock‘
 != 0)

147 
m_sock‘
->
Clo£
();

148 
	gm_cÚÃùed
 = 
çl£
;

149 
	gm_¶ay”
.
	gm_¡©e
 = 
MPEG_PLAYER_DONE
;

153 
NS_LOG_WARN
("DashClient found‚ull socketo close in StopApplication");

159 
	gDashCl›Á
::
Reque¡Segm’t
()

161 
NS_LOG_FUNCTION
(
this
);

163 ià(
	gm_cÚÃùed
 =ğ
çl£
)

168 
	gPŒ
<
	gPack‘
> 
	g·ck‘
 = 
C»©e
<
Pack‘
>(100);

170 
HTTPH—d”
 
	gh‰pH—d”
;

171 
	gh‰pH—d”
.
S‘Seq
(1);

172 
	gh‰pH—d”
.
S‘Mes§geTy³
(
HTTP_REQUEST
);

173 
	gh‰pH—d”
.
S‘VideoId
(
m_videoId
);

174 
	gh‰pH—d”
.
S‘ResŞutiÚ
(
m_b™R©e
);

175 
	gh‰pH—d”
.
S‘Segm’tId
(
m_£gm’tId
++);

176 
	g·ck‘
->
AddH—d”
(
h‰pH—d”
);

179 
	g»s
 = 0;

180 ià(((è(
	g»s
 = 
m_sock‘
->
S’d
(
·ck‘
))è!ğ·ck‘->
G‘Size
())

182 
NS_FATAL_ERROR
(

183 "Oh oh. Couldn'ˆ£nd…ack‘!„es=" << 
»s
 << " size=" << 
·ck‘
->
G‘Size
());

186 
	gm_»que¡Time
 = 
SimuÏtÜ
::
Now
();

187 
	gm_£gm’t_by‹s
 = 0;

192 
	gDashCl›Á
::
HªdËR—d
(
PŒ
<
Sock‘
> 
sock‘
)

194 
NS_LOG_FUNCTION
(
this
 << 
sock‘
);

196 
	gm_·r£r
.
R—dSock‘
(
sock‘
);

201 
	gDashCl›Á
::
CÚÃùiÚSucûeded
(
PŒ
<
Sock‘
> 
sock‘
)

203 
NS_LOG_FUNCTION
(
this
 << 
sock‘
);

204 
NS_LOG_LOGIC
("DashClient Connection succeeded");

205 
	gm_cÚÃùed
 = 
Œue
;

206 
Reque¡Segm’t
();

210 
	gDashCl›Á
::
CÚÃùiÚFaed
(
PŒ
<
Sock‘
> 
sock‘
)

212 
NS_LOG_FUNCTION
(
this
 << 
sock‘
);
NS_LOG_LOGIC
(

217 
	gDashCl›Á
::
D©aS’d
(
PŒ
<
Sock‘
>, 
ušt32_t
)

219 
NS_LOG_FUNCTION
(
this
);

221 ià(
	gm_cÚÃùed
)

224 
NS_LOG_INFO
("Something was sent");

229 
NS_LOG_INFO
("NOT CONNECTED!!!!");

234 
	gDashCl›Á
::
Mes§geReûived
(
Pack‘
 
mes§ge
)

236 
NS_LOG_FUNCTION
(
this
 << 
mes§ge
);

238 
MPEGH—d”
 
	gm³gH—d”
;

239 
HTTPH—d”
 
	gh‰pH—d”
;

242 
	gm_¶ay”
.
ReûiveF¿me
(&
mes§ge
);

243 
	gm_£gm’t_by‹s
 +ğ
mes§ge
.
G‘Size
();

244 
	gm_tÙBy‹s
 +ğ
mes§ge
.
G‘Size
();

248 
	gmes§ge
.
RemoveH—d”
(
m³gH—d”
);

249 
	gmes§ge
.
RemoveH—d”
(
h‰pH—d”
);

252 
	gm_¶ay”
.
	gm_¡©e
)

254 
	gMPEG_PLAYER_PLAYING
:

255 
m_sumDt
 +ğ
m_¶ay”
.
G‘R—lPÏyTime
(
m³gH—d”
.
G‘PÏybackTime
());

257 
	gMPEG_PLAYER_PAUSED
:

259 
	gMPEG_PLAYER_DONE
:

262 
NS_FATAL_ERROR
("WRONG STATE");

265 ià(
	gm³gH—d”
.
G‘F¿meId
(è=ğ
MPEG_FRAMES_PER_SEGMENT
 - 1)

270 
m_£gm’tF‘chTime
 = 
SimuÏtÜ
::
Now
(è- 
m_»que¡Time
;

272 
NS_LOG_INFO
(

273 
SimuÏtÜ
::
Now
().
G‘SecÚds
(è<< " by‹s: " << 
m_£gm’t_by‹s
 << " segm’tTime: " << 
m_£gm’tF‘chTime
.GetSeconds() << " segmentRate: " << 8 * m_segment_bytes / m_segmentFetchTime.GetSeconds());

275 
AddB™R©e
(
SimuÏtÜ
::
Now
(),

276 8 * 
m_£gm’t_by‹s
 / 
m_£gm’tF‘chTime
.
G‘SecÚds
());

278 
Time
 
	gcu¼Dt
 = 
m_¶ay”
.
G‘R—lPÏyTime
(
m³gH—d”
.
G‘PÏybackTime
());

280 
LogBufãrLev–
(
cu¼Dt
);

282 
ušt32_t
 
	gŞd
 = 
m_b™R©e
;

285 
Time
 
	gbufãrD–ay
;

290 
ušt32_t
 
	g´evB™¿‹
 = 
m_b™R©e
;

299 
	gDashCl›Á
::
C®cNextSegm’t
(
´evB™¿‹
, 
m_b™R©e
, 
bufãrD–ay
);

301 ià(
	g´evB™¿‹
 !ğ
m_b™R©e
)

303 
m_¿‹Chªges
++;

306 ià(
	gbufãrD–ay
 =ğ
SecÚds
(0))

308 
Reque¡Segm’t
();

312 
	gm_¶ay”
.
SchduËBufãrWakeup
(
bufãrD–ay
, 
this
);

327 ià(
	gm_£gm’tId
==70084è
DashCl›Á
::
StİAµliÿtiÚ
();

338 
NS_LOG_INFO
(

339 "===ğLa¡ f¿m»ûived. Reque¡šg segm’ˆ" << 
m_£gm’tId
);

342 
NS_LOG_INFO
(

343 "!@#$#@!$@#\t" << 
SimuÏtÜ
::
Now
().
G‘SecÚds
(è<< " old: " << 
Şd
 << "‚ew: " << 
m_b™R©e
 << ": " << 
cu¼Dt
.G‘SecÚds(è<< " dt: " << (cu¼Dˆ- 
m_Ï¡Dt
).GetSeconds());

345 
	gm_Ï¡Dt
 = 
cu¼Dt
;

352 
	gDashCl›Á
::
C®cNextSegm’t
(
ušt32_t
 
cu¼R©e
, ušt32_ˆ& 
ÃxtR©e
,

353 
Time
 & 
d–ay
)

361 
	gÃxtR©e
 = 
cu¼R©e
;

362 
	gd–ay
 = 
SecÚds
(0);

366 
	gDashCl›Á
::
G‘Sts
()

368 
¡d
::
cout
 << " InterruptionTime: "

369 << 
m_¶ay”
.
m_š‹¼u±iÚ_time
.
G‘SecÚds
() << " interruptions: "

370 << 
m_¶ay”
.
m_š‹¼ru±iÚs
 << "‡vgRate: "

371 << (1.0 * 
m_¶ay”
.
m_tÙ®R©e
è/ m_¶ay”.
m_äamesPÏyed


372 << " mšR©e: " << 
m_¶ay”
.
m_mšR©e
 << " AvgDt: "

373 << 
m_sumDt
.
G‘SecÚds
(è/ 
m_¶ay”
.
m_äamesPÏyed
 << " changes: "

374 << 
m_¿‹Chªges
 << 
¡d
::
’dl
;

379 
	gDashCl›Á
::
LogBufãrLev–
(
Time
 
t
)

381 
m_bufãrS‹
[
SimuÏtÜ
::
Now
()] = 
t
;

382 
	g¡d
::
m­
<
Time
, 
	gTime
>::
™”©Ü
 
™
 = 
m_bufãrS‹
.
begš
();

383 
	g™
 !ğ
m_bufãrS‹
.
’d
(); ++it)

385 ià(
	g™
->
	gfœ¡
 < (
	gSimuÏtÜ
::
Now
(è- 
m_wšdow
))

387 
m_bufãrS‹
.
”a£
(
™
->
fœ¡
);

393 
	gDashCl›Á
::
G‘BufãrE¡im©e
()

395 
sum
 = 0;

396 
	gcouÁ
 = 0;

397 
	g¡d
::
m­
<
Time
, 
	gTime
>::
™”©Ü
 
™
 = 
m_bufãrS‹
.
begš
();

398 
	g™
 !ğ
m_bufãrS‹
.
’d
(); ++it)

400 
	gsum
 +ğ
™
->
£cÚd
.
G‘SecÚds
();

401 
	gcouÁ
++;

403  
	gsum
 / 
	gcouÁ
;

407 
	gDashCl›Á
::
G‘BufãrDifã»ÁŸl
()

409 
¡d
::
m­
<
Time
, 
	gTime
>::
™”©Ü
 
™
 = 
m_bufãrS‹
.
’d
();

411 ià(
	g™
 =ğ
m_bufãrS‹
.
begš
())

416 
	g™
--;

417 
Time
 
	gÏ¡
 = 
™
->
£cÚd
;

419 ià(
	g™
 =ğ
m_bufãrS‹
.
begš
())

424 
	g™
--;

425 
Time
 
	g´ev
 = 
™
->
£cÚd
;

426  (
	gÏ¡
 - 
	g´ev
).
G‘SecÚds
();

430 
	gDashCl›Á
::
G‘Segm’tF‘chTime
()

432  
m_£gm’tF‘chTime
.
G‘SecÚds
();

436 
	gDashCl›Á
::
AddB™R©e
(
Time
 
time
, 
b™¿‹
)

438 
	gm_b™¿‹s
[
time
] = 
b™¿‹
;

439 
	gsum
 = 0;

440 
	gcouÁ
 = 0;

441 
	g¡d
::
m­
<
Time
, >::
™”©Ü
 
™
 = 
m_b™¿‹s
.
begš
();

442 
	g™
 !ğ
m_b™¿‹s
.
’d
(); ++it)

444 ià(
	g™
->
	gfœ¡
 < (
	gSimuÏtÜ
::
Now
(è- 
m_wšdow
))

446 
m_b™¿‹s
.
”a£
(
™
->
fœ¡
);

450 
	gsum
 +ğ
™
->
£cÚd
;

451 
	gcouÁ
++;

454 
	gm_b™¿‹E¡im©e
 = 
sum
 / 
couÁ
;

	@model/dash-client.h

21 #iâdeà
DASH_CLIENT_H


22 
	#DASH_CLIENT_H


	)

24 
	~"ns3/­¶iÿtiÚ.h
"

25 
	~"ns3/±r.h
"

26 
	~"ns3/sock‘.h
"

27 
	~"m³g-¶ay”.h
"

28 
	~"ns3/Œaûd-ÿÎback.h
"

29 
	~"h‰p-·r£r.h
"

32 
Çme¥aû
 
	gns3


60 şas 
	cDashCl›Á
 : 
public
 
AµliÿtiÚ


62 
ä›nd
 
şass
 
M³gPÏy”
;

63 
ä›nd
 
şass
 
	gH‰pP¬£r
;

64 
	gpublic
:

65 
Ty³Id


66 
G‘Ty³Id
();

68 
DashCl›Á
();

70 
	gvœtu®


71 ~
DashCl›Á
();

76 
	gPŒ
<
	gSock‘
>

77 
G‘Sock‘
() const;

83 
G‘Sts
();

90 
šlše
 
	gM³gPÏy”
 &

91 
G‘PÏy”
()

93  
	gm_¶ay”
;

96 
	g´Ùeùed
:

97 
vœtu®
 

98 
DoDi¥o£
();

100 
šlše


101 
G‘B™R©eE¡im©e
()

103  
	gm_b™¿‹E¡im©e
;

106 
G‘BufãrDifã»ÁŸl
();

109 
AddB™R©e
(
Time
 
time
, 
b™¿‹
);

112 
G‘BufãrE¡im©e
();

115 
G‘Segm’tF‘chTime
();

117 
	g¡d
::
m­
<
Time
, 
	gTime
> 
	gm_bufãrS‹
;

118 
ušt32_t
 
	gm_¿‹Chªges
;

119 
Time
 
	gm_rg‘_dt
;

120 
	g¡d
::
m­
<
Time
, > 
	gm_b™¿‹s
;

121 
	gm_b™¿‹E¡im©e
;

122 
ušt32_t
 
	gm_£gm’tId
;

124 
	g´iv©e
:

132 
Reque¡Segm’t
();

141 
Mes§geReûived
(
Pack‘
 
mes§ge
);

144 
vœtu®
 

145 
S¹AµliÿtiÚ
();

146 
vœtu®
 

147 
StİAµliÿtiÚ
();

149 
CÚÃùiÚSucûeded
(
PŒ
<
Sock‘
> 
sock‘
);

151 
CÚÃùiÚFaed
(
PŒ
<
Sock‘
> 
sock‘
);

153 
D©aS’d
(
PŒ
<
Sock‘
>, 
ušt32_t
);

155 
HªdËR—d
(
PŒ
<
Sock‘
>);

156 
vœtu®
 

157 
C®cNextSegm’t
(
ušt32_t
 
cu¼R©e
, ušt32_ˆ& 
ÃxtR©e
, 
Time
 & 
d–ay
);

159 
LogBufãrLev–
(
Time
 
t
);

160 
šlše


161 
S‘Wšdow
(
Time
 
time
)

163 
	gm_wšdow
 = 
time
;

166 
M³gPÏy”
 
	gm_¶ay”
;

167 
H‰pP¬£r
 
	gm_·r£r
;

168 
	gPŒ
<
	gSock‘
> 
	gm_sock‘
;

169 
Add»ss
 
	gm_³”
;

170 
boŞ
 
	gm_cÚÃùed
;

171 
ušt32_t
 
	gm_tÙBy‹s
;

172 
Ty³Id
 
	gm_tid
;

173 
	gT¿ûdC®lback
<
	gPŒ
<cÚ¡ 
	gPack‘
> > 
	gm_txT¿û
;

174 
ušt32_t
 
	gm_videoId
;

175 
Time
 
	gm_¡¬‹dReûivšg
;

176 
Time
 
	gm_sumDt
;

177 
Time
 
	gm_Ï¡Dt
;

178 
	gm_couÁObjs
;

179 
	gm_id
;

180 
Time
 
	gm_»que¡Time
;

181 
ušt32_t
 
	gm_£gm’t_by‹s
;

182 
ušt32_t
 
	gm_b™R©e
;

183 
Time
 
	gm_wšdow
;

184 
Time
 
	gm_£gm’tF‘chTime
;

	@model/dash-server.cc

21 
	~"ns3/add»ss.h
"

22 
	~"ns3/add»ss-uts.h
"

23 
	~"ns3/log.h
"

24 
	~"ns3/š‘-sock‘-add»ss.h
"

25 
	~"ns3/š‘6-sock‘-add»ss.h
"

26 
	~"ns3/node.h
"

27 
	~"ns3/sock‘.h
"

28 
	~"ns3/udp-sock‘.h
"

29 
	~"ns3/simuÏtÜ.h
"

30 
	~"ns3/sock‘-çùÜy.h
"

31 
	~"ns3/·ck‘.h
"

32 
	~"ns3/Œaû-sourû-acûssÜ.h
"

33 
	~"ns3/udp-sock‘-çùÜy.h
"

34 
	~"dash-£rv”.h
"

35 
	~"h‰p-h—d”.h
"

36 
	~"m³g-h—d”.h
"

37 
	~<ns3/¿ndom-v¬ŸbË-¡»am.h
>

38 
	~<ns3/tı-sock‘.h
>

39 
	~<ns3/doubË.h
>

40 
	~"·¿.h
"

41 
usšg
 
Çme¥aû
 
	g¡d
;

44 
Çme¥aû
 
	gns3


46 
NS_LOG_COMPONENT_DEFINE
("DashServer");

47 
NS_OBJECT_ENSURE_REGISTERED
(
DashS”v”
);

49 
Ty³Id


50 
	gDashS”v”
::
G‘Ty³Id
()

52 
Ty³Id
 
tid
 =

53 
Ty³Id
("ns3::DashS”v”").
S‘P¬’t
<
AµliÿtiÚ
>().
AddCÚ¡ruùÜ
<

54 
DashS”v”
>().
AddA‰ribu‹
("Local",

55 "ThAdd»s Ú whichØBšdhrx sock‘.", 
Add»ssV®ue
(),

56 
MakeAdd»ssAcûssÜ
(&
DashS”v”
::
m_loÿl
), 
MakeAdd»ssCheck”
()).
AddA‰ribu‹
(

58 
Ty³IdV®ue
(
UdpSock‘FaùÜy
::
G‘Ty³Id
()),

59 
MakeTy³IdAcûssÜ
(&
DashS”v”
::
m_tid
), 
MakeTy³IdCheck”
()).
AddT¿ûSourû
(

61 
MakeT¿ûSourûAcûssÜ
(&
DashS”v”
::
m_rxT¿û
));

62  
	gtid
;

65 
	gDashS”v”
::
DashS”v”
()

67 
NS_LOG_FUNCTION
(
this
);

68 
	gm_sock‘
 = 0;

69 
	gm_tÙ®Rx
 = 0;

72 
	gDashS”v”
::~
DashS”v”
()

74 
NS_LOG_FUNCTION
(
this
);

77 
	gPŒ
<
	gSock‘
>

78 
	gDashS”v”
::
G‘Li¡’šgSock‘
() const

80 
NS_LOG_FUNCTION
(
this
);

81  
	gm_sock‘
;

84 
	g¡d
::
li¡
<
PŒ
<
Sock‘
> >

85 
DashS”v”
::
G‘Acû±edSock‘s
() const

87 
NS_LOG_FUNCTION
(
this
);

88  
	gm_sock‘Li¡
;

92 
	gDashS”v”
::
DoDi¥o£
()

94 
NS_LOG_FUNCTION
(
this
);

95 
	gm_sock‘
 = 0;

96 
	gm_sock‘Li¡
.
ş—r
();

99 
	gAµliÿtiÚ
::
DoDi¥o£
();

104 
	gDashS”v”
::
S¹AµliÿtiÚ
()

106 
NS_LOG_FUNCTION
(
this
);

108 ià(!
	gm_sock‘
)

110 
	gm_sock‘
 = 
Sock‘
::
C»©eSock‘
(
G‘Node
(), 
m_tid
);

111 
	gm_sock‘
->
Bšd
(
m_loÿl
);

112 
	gm_sock‘
->
Li¡’
();

114 ià(
	gadd»ssUts
::
IsMuÉiÿ¡
(
m_loÿl
))

116 
PŒ
<
UdpSock‘
> 
udpSock‘
 = 
DyÇmicCa¡
<UdpSock‘>(
m_sock‘
);

117 ià(
	gudpSock‘
)

120 
	gudpSock‘
->
MuÉiÿ¡JošGroup
(0, 
m_loÿl
);

124 
NS_FATAL_ERROR
("Error: joining multicast on‡‚on-UDP socket");

129 
	gm_sock‘
->
S‘RecvC®lback
(
MakeC®lback
(&
DashS”v”
::
HªdËR—d
, 
this
));

131 
	gm_sock‘
->
S‘Acû±C®lback
(

132 
MakeNuÎC®lback
<
boŞ
, 
PŒ
<
Sock‘
>, cÚ¡ 
Add»ss
 &>(),

133 
MakeC®lback
(&
DashS”v”
::
HªdËAcû±
, 
this
));

134 
	gm_sock‘
->
S‘Clo£C®lbacks
(

135 
MakeC®lback
(&
DashS”v”
::
HªdËP“rClo£
, 
this
),

136 
MakeC®lback
(&
DashS”v”
::
HªdËP“rE¼Ü
, 
this
));

140 
	gDashS”v”
::
StİAµliÿtiÚ
()

142 
NS_LOG_FUNCTION
(
this
);

143 !
	gm_sock‘Li¡
.
em±y
())

145 
	gPŒ
<
	gSock‘
> 
	gacû±edSock‘
 = 
m_sock‘Li¡
.
äÚt
();

146 
	gm_sock‘Li¡
.
pİ_äÚt
();

147 
	gacû±edSock‘
->
Clo£
();

149 ià(
	gm_sock‘
)

151 
	gm_sock‘
->
Clo£
();

152 
	gm_sock‘
->
S‘RecvC®lback
(
MakeNuÎC®lback
<, 
PŒ
<
Sock‘
> >());

157 
	gDashS”v”
::
HªdËR—d
(
PŒ
<
Sock‘
> 
sock‘
)

159 
NS_LOG_FUNCTION
(
this
 << 
sock‘
);

160 
	gPŒ
<
	gPack‘
> 
	g·ck‘
;

161 
Add»ss
 
	gäom
;

162 (
	g·ck‘
 = 
sock‘
->
RecvFrom
(
äom
)))

164 ià(
·ck‘
->
G‘Size
() == 0)

168 
	gm_tÙ®Rx
 +ğ
·ck‘
->
G‘Size
();

170 
HTTPH—d”
 
	gh—d”
;

171 
	g·ck‘
->
RemoveH—d”
(
h—d”
);

175 
S’dSegm’t
(
h—d”
.
G‘VideoId
(), h—d”.
G‘ResŞutiÚ
(),

176 
h—d”
.
G‘Segm’tId
(), 
sock‘
);

178 ià(
	gIÃtSock‘Add»ss
::
IsM©chšgTy³
(
äom
))

180 
NS_LOG_INFO
(

181 "Aˆtim" << 
SimuÏtÜ
::
Now
 ().
G‘SecÚds
 (è<< " ·ck‘ sšk„eûived " << 
·ck‘
->
G‘Size
 (è<< " by‹ äom " << 
IÃtSock‘Add»ss
::
CÚv”tFrom
(
äom
).
G‘Ipv4
 (è<< "…Üˆ" << IÃtSock‘Add»ss::CÚv”tFrom (äom).
G‘PÜt
 (è<< "Ù® Rx " << 
m_tÙ®Rx
 << " bytes");

183 ià(
	gIÃt6Sock‘Add»ss
::
IsM©chšgTy³
(
äom
))

185 
NS_LOG_INFO
(

186 "Aˆtim" << 
SimuÏtÜ
::
Now
 ().
G‘SecÚds
 (è<< " ·ck‘ sšk„eûived " << 
·ck‘
->
G‘Size
 (è<< " by‹ äom " << 
IÃt6Sock‘Add»ss
::
CÚv”tFrom
(
äom
).
G‘Ipv6
 (è<< "…Üˆ" << IÃt6Sock‘Add»ss::CÚv”tFrom (äom).
G‘PÜt
 (è<< "Ù® Rx " << 
m_tÙ®Rx
 << " bytes");

188 
m_rxT¿û
(
·ck‘
, 
äom
);

193 
	gDashS”v”
::
HªdËP“rClo£
(
PŒ
<
Sock‘
> 
sock‘
)

195 
NS_LOG_FUNCTION
(
this
 << 
sock‘
);

199 
	gDashS”v”
::
HªdËP“rE¼Ü
(
PŒ
<
Sock‘
> 
sock‘
)

201 
NS_LOG_FUNCTION
(
this
 << 
sock‘
);

205 
	gDashS”v”
::
HªdËAcû±
(
PŒ
<
Sock‘
> 
s
, cÚ¡ 
Add»ss
& 
äom
)

207 
NS_LOG_FUNCTION
(
this
 << 
s
 << 
äom
);

208 
	gs
->
S‘RecvC®lback
(
MakeC®lback
(&
DashS”v”
::
HªdËR—d
, 
this
));

209 
	gs
->
S‘S’dC®lback
(
MakeC®lback
(&
DashS”v”
::
D©aS’d
, 
this
));

210 
	gm_sock‘Li¡
.
push_back
(
s
);

215 
	gDashS”v”
::
D©aS’d
(
PŒ
<
Sock‘
> 
sock‘
, 
ušt32_t
)

217 
NS_LOG_FUNCTION
(
this
);

218 
	g¡d
::
m­
<
PŒ
<
Sock‘
>, std::
queue
<
Pack‘
> >::
™”©Ü
 
™”
 =

219 
m_queues
.
begš
(); 
	g™”
 !ğm_queues.
’d
(); ++iter)

221 
HTTPH—d”
 
	gh‰pH—d”
;

222 
MPEGH—d”
 
	gm³gH—d”
;

224 ià(
	g™”
->
	g£cÚd
.
size
())

226 
	gPŒ
<
	gPack‘
> 
	gäame
 = 
™”
->
£cÚd
.
äÚt
().
Cİy
();

228 
	gäame
->
RemoveH—d”
(
m³gH—d”
);

229 
	gäame
->
RemoveH—d”
(
h‰pH—d”
);

231 
NS_LOG_INFO
(

232 "VidId: " << 
h‰pH—d”
.
G‘VideoId
(è<< "„xAvğ" << 
™”
->
fœ¡
->
G‘RxAvaabË
(è<< " queueğ"<< i‹r->
£cÚd
.
size
(è<< "„esğ" << h‰pH—d”.
G‘ResŞutiÚ
());

236 !
	gm_queues
[
sock‘
].
em±y
())

238 
	gby‹s
;

239 
	gPŒ
<
	gPack‘
> 
	gäame
 = 
m_queues
[
sock‘
].
äÚt
().
Cİy
();

240 ià((
	gby‹s
 = 
sock‘
->
S’d
(
äame
)è!ğ(èäame->
G‘Size
())

242 
NS_LOG_INFO
("Could‚ot send frame");

243 ià(
	gby‹s
 != -1)

245 
NS_FATAL_ERROR
("Oops, we sent half‡ frame :(");

249 
	gm_queues
[
sock‘
].
pİ
();

252 
NS_LOG_INFO
("DATA WAS JUST SENT!!!");

257 
	gDashS”v”
::
S’dSegm’t
(
ušt32_t
 
video_id
, ušt32_ˆ
»sŞutiÚ
,

258 
ušt32_t
 
£gm’t_id
, 
PŒ
<
Sock‘
> 
sock‘
)

262 
	gco
=0;

263 if(
	gco
==0){

264 
cout
<<"š s”v” side"<<
’dl
;

265 
size_t
 
	gj
=0,
	gmax
=
video_num
.
size
();j!=
max
;j++){

266 
	gcout
<<
	gvideo_num
[
j
]<<
	g’dl
;

268 
	gco
++;

273 
	gavg_·ck‘size
 = 
»sŞutiÚ
 / (50 * 8);

275 
HTTPH—d”
 
	gh‰p_h—d”_tmp
;

276 
MPEGH—d”
 
	gm³g_h—d”_tmp
;

278 
	gPŒ
<
	gUnifÜmRªdomV¬ŸbË
> 
	gäame_size_g’
 = 
C»©eObjeù
<
UnifÜmRªdomV¬ŸbË
> ();

280 
	gäame_size_g’
->
S‘A‰ribu‹
 ("Mš", 
DoubËV®ue
 (1288));

289 
	gäame_size_g’
->
S‘A‰ribu‹
 ("Max", 
DoubËV®ue
 (1288));

292 
ušt32_t
 
	gf_id
 = 0; f_id < 
	gMPEG_FRAMES_PER_SEGMENT
; f_id++)

294 
ušt32_t
 
	gäame_size
 = (è
äame_size_g’
->
G‘V®ue
();

298 
HTTPH—d”
 
	gh‰p_h—d”
;

299 
	gh‰p_h—d”
.
S‘Mes§geTy³
(
HTTP_RESPONSE
);

300 
	gh‰p_h—d”
.
S‘VideoId
(
video_id
);

301 
	gh‰p_h—d”
.
S‘ResŞutiÚ
(
»sŞutiÚ
);

302 
	gh‰p_h—d”
.
S‘Segm’tId
(
£gm’t_id
);

304 
MPEGH—d”
 
	gm³g_h—d”
;

305 
	gm³g_h—d”
.
S‘F¿meId
(
f_id
);

306 
	gm³g_h—d”
.
S‘PÏybackTime
(

307 
MliSecÚds
(

308 (
f_id
 + (
£gm’t_id
 * 
MPEG_FRAMES_PER_SEGMENT
))

309 * 
MPEG_TIME_BETWEEN_FRAMES
));

315 
	gm³g_h—d”
.
S‘Ty³
('B');

316 
	gm³g_h—d”
.
S‘Size
(
äame_size
);

318 
	gPŒ
<
	gPack‘
> 
	gäame
 = 
C»©e
<
Pack‘
>(
äame_size
);

319 
	gäame
->
AddH—d”
(
h‰p_h—d”
);

320 
	gäame
->
AddH—d”
(
m³g_h—d”
);

321 
NS_LOG_INFO
(

322 "SENDING PACKET " << 
f_id
 << " " << 
äame
->
G‘Size
(è<< "„es=" << 
h‰p_h—d”
.
G‘ResŞutiÚ
(è<< " size=" << 
m³g_h—d”
.G‘Size(è<< "‡vg=" << 
avg_·ck‘size
);

324 
	gm_queues
[
sock‘
].
push
(*
äame
);

326 
D©aS’d
(
sock‘
, 0);

	@model/dash-server.h

21 #iâdeà
DASH_SERVER_H


22 
	#DASH_SERVER_H


	)

24 
	~"ns3/­¶iÿtiÚ.h
"

25 
	~"ns3/ev’t-id.h
"

26 
	~"ns3/±r.h
"

27 
	~"ns3/Œaûd-ÿÎback.h
"

28 
	~"ns3/add»ss.h
"

29 
	~<m­
>

30 
	~<queue
>

32 
Çme¥aû
 
	gns3


35 
şass
 
	gAdd»ss
;

36 
şass
 
	gSock‘
;

37 
şass
 
	gPack‘
;

52 şas 
	cDashS”v”
 : 
public
 
AµliÿtiÚ


54 
public
:

55 
Ty³Id


56 
G‘Ty³Id
();

57 
DashS”v”
();

59 
	gvœtu®


60 ~
DashS”v”
();

65 
	gPŒ
<
	gSock‘
>

66 
G‘Li¡’šgSock‘
() const;

71 
	g¡d
::
li¡
<
PŒ
<
Sock‘
> >

72 
G‘Acû±edSock‘s
() const;

74 
	g´Ùeùed
:

75 
vœtu®
 

76 
DoDi¥o£
();

77 
	g´iv©e
:

79 
vœtu®
 

80 
S¹AµliÿtiÚ
();

81 
vœtu®
 

82 
StİAµliÿtiÚ
();

85 
HªdËR—d
(
PŒ
<
Sock‘
>);

87 
D©aS’d
(
PŒ
<
Sock‘
>, 
ušt32_t
);

90 
S’dSegm’t
(
ušt32_t
 
video_id
, ušt32_ˆ
»sŞutiÚ
, ušt32_ˆ
£gm’t_id
,

91 
PŒ
<
Sock‘
> 
sock‘
);

93 
HªdËAcû±
(
PŒ
<
Sock‘
>, cÚ¡ 
Add»ss
& 
äom
);

95 
HªdËP“rClo£
(
PŒ
<
Sock‘
>);

97 
HªdËP“rE¼Ü
(
PŒ
<
Sock‘
>);

101 
	gPŒ
<
	gSock‘
> 
	gm_sock‘
;

102 
	g¡d
::
li¡
<
PŒ
<
Sock‘
> > 
m_sock‘Li¡
;

104 
Add»ss
 
	gm_loÿl
;

105 
ušt32_t
 
	gm_tÙ®Rx
;

106 
Ty³Id
 
	gm_tid
;

107 
	gT¿ûdC®lback
<
	gPŒ
<cÚ¡ 
	gPack‘
>, cÚ¡ 
	gAdd»ss
 &> 
	gm_rxT¿û
;

110 
	g¡d
::
m­
<
PŒ
<
Sock‘
>, std::
queue
<
Pack‘
> > 
m_queues
;

	@model/http-header.cc

21 
	~"ns3/as£¹.h
"

22 
	~"ns3/log.h
"

23 
	~"ns3/h—d”.h
"

24 
	~"ns3/simuÏtÜ.h
"

25 
	~"h‰p-h—d”.h
"

27 
NS_LOG_COMPONENT_DEFINE
("HTTPHeader");

29 
Çme¥aû
 
	gns3


32 
NS_OBJECT_ENSURE_REGISTERED
 (
HTTPH—d”
)

35 
	gHTTPH—d”
::
HTTPH—d”
() :

36 
m_£q
(0), 
m_ts
(
SimuÏtÜ
::
Now
().
G‘TimeS‹p
()), 
m_mes§ge_ty³
(

37 
HTTP_REQUEST
), 
m_video_id
(0), 
m_»sŞutiÚ
(0), 
m_£gm’t_id
(0)

40 
NS_LOG_FUNCTION
(
this
);

44 
	gHTTPH—d”
::
S‘Seq
(
ušt32_t
 
£q
)

46 
NS_LOG_FUNCTION
(
this
 << 
£q
);

47 
	gm_£q
 = 
£q
;

49 
ušt32_t


50 
	gHTTPH—d”
::
G‘Seq
() const

52 
NS_LOG_FUNCTION
(
this
);

53  
	gm_£q
;

57 
	gHTTPH—d”
::
S‘Mes§geTy³
(
ušt32_t
 
mes§ge_ty³
)

59 
NS_LOG_FUNCTION
(
this
 << 
mes§ge_ty³
);

60 
	gm_mes§ge_ty³
 = 
mes§ge_ty³
;

63 
ušt32_t


64 
	gHTTPH—d”
::
G‘Mes§geTy³
() const

66 
NS_LOG_FUNCTION
(
this
);

67  
	gm_mes§ge_ty³
;

70 
	gHTTPH—d”
::
S‘VideoId
(
ušt32_t
 
video_id
)

73 
NS_LOG_FUNCTION
(
this
 << 
video_id
);

74 
	gm_video_id
 = 
video_id
;

76 
ušt32_t


77 
	gHTTPH—d”
::
G‘VideoId
() const

80 
NS_LOG_FUNCTION
(
this
);

81  
	gm_video_id
;

84 
	gHTTPH—d”
::
S‘ResŞutiÚ
(
ušt32_t
 
»sŞutiÚ
)

87 
NS_LOG_FUNCTION
(
this
 << 
»sŞutiÚ
);

88 
	gm_»sŞutiÚ
 = 
»sŞutiÚ
;

90 
ušt32_t


91 
	gHTTPH—d”
::
G‘ResŞutiÚ
() const

93 
NS_LOG_FUNCTION
(
this
);

94  
	gm_»sŞutiÚ
;

98 
	gHTTPH—d”
::
S‘Segm’tId
(
ušt32_t
 
£gm’t_id
)

100 
NS_LOG_FUNCTION
(
this
 << 
£gm’t_id
);

101 
	gm_£gm’t_id
 = 
£gm’t_id
;

103 
ušt32_t


104 
	gHTTPH—d”
::
G‘Segm’tId
() const

106 
NS_LOG_FUNCTION
(
this
);

107  
	gm_£gm’t_id
;

110 
Time


111 
	gHTTPH—d”
::
G‘Ts
() const

113 
NS_LOG_FUNCTION
(
this
);

114  
TimeS‹p
(
m_ts
);

117 
Ty³Id


118 
	gHTTPH—d”
::
G‘Ty³Id
()

120 
Ty³Id
 
tid
 =

121 
Ty³Id
("ns3::HTTPH—d”").
S‘P¬’t
<
H—d”
>().
AddCÚ¡ruùÜ
<
HTTPH—d”
>();

122  
	gtid
;

124 
Ty³Id


125 
	gHTTPH—d”
::
G‘In¡ªûTy³Id
() const

127  
G‘Ty³Id
();

130 
	gHTTPH—d”
::
Pršt
(
¡d
::
o¡»am
 &
os
) const

132 
NS_LOG_FUNCTION
(
this
 << &
os
);

133 
	gos
 << "(£q=" << 
	gm_£q
 << "ime=" << 
TimeS‹p
(
m_ts
).
G‘SecÚds
() << ")";

135 
ušt32_t


136 
	gHTTPH—d”
::
G‘S”ŸlizedSize
() const

138 
NS_LOG_FUNCTION
(
this
);

143 
	gHTTPH—d”
::
S”Ÿlize
(
Bufãr
::
I‹¿tÜ
 
¡¬t
) const

145 
NS_LOG_FUNCTION
(
this
 << &
¡¬t
);

146 
	gBufãr
::
I‹¿tÜ
 
i
 = 
¡¬t
;

147 
	gi
.
Wr™eHtÚU32
(
m_£q
);

148 
	gi
.
Wr™eHtÚU64
(
m_ts
);

149 
	gi
.
Wr™eHtÚU32
(
m_mes§ge_ty³
);

150 
	gi
.
Wr™eHtÚU32
(
m_video_id
);

151 
	gi
.
Wr™eHtÚU32
(
m_»sŞutiÚ
);

152 
	gi
.
Wr™eHtÚU32
(
m_£gm’t_id
);

154 
ušt32_t


155 
	gHTTPH—d”
::
De£rŸlize
(
Bufãr
::
I‹¿tÜ
 
¡¬t
)

157 
NS_LOG_FUNCTION
(
this
 << &
¡¬t
);

158 
	gBufãr
::
I‹¿tÜ
 
i
 = 
¡¬t
;

159 
	gm_£q
 = 
i
.
R—dNtohU32
();

160 
	gm_ts
 = 
i
.
R—dNtohU64
();

161 
	gm_mes§ge_ty³
 = 
i
.
R—dNtohU32
();

162 
	gm_video_id
 = 
i
.
R—dNtohU32
();

163 
	gm_»sŞutiÚ
 = 
i
.
R—dNtohU32
();

164 
	gm_£gm’t_id
 = 
i
.
R—dNtohU32
();

165  
G‘S”ŸlizedSize
();

	@model/http-header.h

21 #iâdeà
HTTP_TS_HEADER_H


22 
	#HTTP_TS_HEADER_H


	)

24 
	~"ns3/h—d”.h
"

25 
	~"ns3/n¡ime.h
"

27 
Çme¥aû
 
	gns3


35 
	#HTTP_REQUEST
 0

	)

36 
	#HTTP_RESPONSE
 1

	)

38 şas 
	cHTTPH—d”
 : 
public
 
H—d”


40 
public
:

41 
HTTPH—d”
();

47 
S‘Seq
(
ušt32_t
 
£q
);

52 
ušt32_t


53 
G‘Seq
() const;

59 
S‘Mes§geTy³
(
ušt32_t
 
mes§ge_ty³
);

60 
ušt32_t


61 
G‘Mes§geTy³
() const;

64 
S‘VideoId
(
ušt32_t
 
video_id
);

65 
ušt32_t


66 
G‘VideoId
() const;

69 
S‘ResŞutiÚ
(
ušt32_t
 
»sŞutiÚ
);

70 
ušt32_t


71 
G‘ResŞutiÚ
() const;

74 
S‘Segm’tId
(
ušt32_t
 
£gm’t_id
);

75 
ušt32_t


76 
G‘Segm’tId
() const;

78 
Time


79 
G‘Ts
() const;

81 
Ty³Id


82 
G‘Ty³Id
();

84 
vœtu®
 
ušt32_t


85 
G‘S”ŸlizedSize
() const;

87 
	g´iv©e
:

88 
vœtu®
 
Ty³Id


89 
G‘In¡ªûTy³Id
() const;

90 
vœtu®
 

91 
Pršt
(
¡d
::
o¡»am
 &
os
) const;

92 
vœtu®
 

93 
S”Ÿlize
(
Bufãr
::
I‹¿tÜ
 
¡¬t
) const;

94 
vœtu®
 
ušt32_t


95 
De£rŸlize
(
Bufãr
::
I‹¿tÜ
 
¡¬t
);

97 
ušt32_t
 
	gm_£q
;

98 
ušt64_t
 
	gm_ts
;

100 
ušt32_t
 
	gm_mes§ge_ty³
;

101 
ušt32_t
 
	gm_video_id
;

102 
ušt32_t
 
	gm_»sŞutiÚ
;

103 
ušt32_t
 
	gm_£gm’t_id
;

	@model/http-parser.cc

21 
	~"h‰p-·r£r.h
"

22 
	~"ns3/log.h
"

23 
	~"ns3/add»ss.h
"

24 
	~"ns3/sock‘.h
"

25 
	~"ns3/·ck‘.h
"

26 
	~"ns3/simuÏtÜ.h
"

27 
	~"h‰p-h—d”.h
"

28 
	~"m³g-h—d”.h
"

29 
	~"dash-ş›Á.h
"

31 
NS_LOG_COMPONENT_DEFINE
("HttpParser");

33 
Çme¥aû
 
	gns3


36 
	gH‰pP¬£r
::
H‰pP¬£r
() :

37 
m_by‹s
(0), 
m_­p
(
NULL
), 
m_Ï¡m—su»m’t
("0s")

39 
NS_LOG_FUNCTION
(
this
);

42 
	gH‰pP¬£r
::~
H‰pP¬£r
()

44 
NS_LOG_FUNCTION
(
this
);

48 
	gH‰pP¬£r
::
S‘Aµ
(
DashCl›Á
 *
­p
)

50 
NS_LOG_FUNCTION
(
this
 << 
­p
);

51 
	gm_­p
 = 
­p
;

54 
	gH‰pP¬£r
::
R—dSock‘
(
PŒ
<
Sock‘
> 
sock‘
)

56 
NS_LOG_FUNCTION
(
this
 << 
sock‘
);

57 
Add»ss
 
	gäom
;

58 
	gby‹s
 = 
sock‘
->
RecvFrom
(&
m_bufãr
[
m_by‹s
], 
MPEG_MAX_MESSAGE
 - m_bytes,

59 0, 
äom
);

61 
MPEGH—d”
 
	gm³g_h—d”
;

62 
HTTPH—d”
 
	gh‰p_h—d”
;

64 
ušt32_t
 
	gh—d”size
 = 
m³g_h—d”
.
G‘S”ŸlizedSize
()

65 + 
h‰p_h—d”
.
G‘S”ŸlizedSize
();

67 ià(
	gby‹s
 > 0)

69 
	gm_by‹s
 +ğ
by‹s
;

71 ià(
	gm_Ï¡m—su»m’t
 > 
Time
("0s"))

73 
NS_LOG_INFO
(

74 
SimuÏtÜ
::
Now
().
G‘SecÚds
(è<< " by‹s: " << 
by‹s
 << " dt: " << (SimuÏtÜ::Now(è- 
m_Ï¡m—su»m’t
).G‘SecÚds(è<< " b™¿‹: " << (8 * (by‹ + 
h—d”size
)/ (Simulator::Now() - m_lastmeasurement).GetSeconds()));

76 
	gm_Ï¡m—su»m’t
 = 
SimuÏtÜ
::
Now
();

79 
NS_LOG_INFO
(

80 "### Bufã¸¥aû: " << 
m_by‹s
 << " QueuËngth " << 
m_­p
->
G‘PÏy”
().
G‘QueueSize
());

82 ià(
	gm_by‹s
 < 
	gh—d”size
)

87 
Pack‘
 
h—d”Pack‘
(
m_bufãr
, 
h—d”size
);

88 
	gh—d”Pack‘
.
RemoveH—d”
(
m³g_h—d”
);

90 
ušt32_t
 
	gmes§ge_size
 = 
h—d”size
 + 
m³g_h—d”
.
G‘Size
();

92 ià(
	gm_by‹s
 < 
	gmes§ge_size
)

96 
Pack‘
 
mes§ge
(
m_bufãr
, 
mes§ge_size
);

98 
memmove
(
m_bufãr
, &m_bufãr[
mes§ge_size
], 
m_by‹s
 - message_size);

99 
	gm_by‹s
 -ğ
mes§ge_size
;

100 
	gm_­p
->
Mes§geReûived
(
mes§ge
);

102 
R—dSock‘
(
sock‘
);

	@model/http-parser.h

21 #iâdeà
HTTP_PARSER_H_


22 
	#HTTP_PARSER_H_


	)

24 
	~<ns3/±r.h
>

25 
	~"m³g-h—d”.h
"

27 
Çme¥aû
 
	gns3


30 
şass
 
	gSock‘
;

31 
şass
 
	gDashCl›Á
;

33 şas 
	cH‰pP¬£r


35 
	gpublic
:

36 
H‰pP¬£r
();

37 
	gvœtu®


38 ~
H‰pP¬£r
();

40 
R—dSock‘
(
PŒ
<
Sock‘
> 
sock‘
);

42 
S‘Aµ
(
DashCl›Á
 *
­p
);

44 
	g´iv©e
:

45 
ušt8_t
 
m_bufãr
[
MPEG_MAX_MESSAGE
];

46 
ušt32_t
 
	gm_by‹s
;

47 
DashCl›Á
 *
	gm_­p
;

49 
Time
 
	gm_Ï¡m—su»m’t
;

	@model/mpeg-header.cc

21 
	~"ns3/as£¹.h
"

22 
	~"ns3/log.h
"

23 
	~"ns3/h—d”.h
"

24 
	~"ns3/simuÏtÜ.h
"

25 
	~"m³g-h—d”.h
"

27 
NS_LOG_COMPONENT_DEFINE
("MPEGHeader");

29 
Çme¥aû
 
	gns3


32 
NS_OBJECT_ENSURE_REGISTERED
 (
MPEGH—d”
)

35 
	gMPEGH—d”
::
MPEGH—d”
() :

36 
m_£q
(0), 
m_ts
(
SimuÏtÜ
::
Now
().
G‘TimeS‹p
()), 
m_äame_id
(0), 
m_¶ayback_time
(

37 0), 
m_ty³
('B')

40 
NS_LOG_FUNCTION
(
this
);

44 
	gMPEGH—d”
::
S‘Seq
(
ušt32_t
 
£q
)

46 
NS_LOG_FUNCTION
(
this
 << 
£q
);

47 
	gm_£q
 = 
£q
;

49 
ušt32_t


50 
	gMPEGH—d”
::
G‘Seq
() const

52 
NS_LOG_FUNCTION
(
this
);

53  
	gm_£q
;

57 
	gMPEGH—d”
::
S‘F¿meId
(
ušt32_t
 
äame_id
)

59 
NS_LOG_FUNCTION
(
this
);

60 
	gm_äame_id
 = 
äame_id
;

62 
ušt32_t


63 
	gMPEGH—d”
::
G‘F¿meId
() const

65 
NS_LOG_FUNCTION
(
this
);

66  
	gm_äame_id
;

70 
	gMPEGH—d”
::
S‘PÏybackTime
(
Time
 
¶ayback_time
)

72 
NS_LOG_FUNCTION
(
this
);

73 
	gm_¶ayback_time
 = 
¶ayback_time
.
G‘TimeS‹p
();

75 
Time


76 
	gMPEGH—d”
::
G‘PÏybackTime
() const

78 
NS_LOG_FUNCTION
(
this
);

79  
TimeS‹p
(
m_¶ayback_time
);

83 
	gMPEGH—d”
::
S‘Ty³
(
ušt32_t
 
ty³
)

85 
NS_LOG_FUNCTION
(
this
);

86 
	gm_ty³
 = 
ty³
;

88 
ušt32_t


89 
	gMPEGH—d”
::
G‘Ty³
() const

91 
NS_LOG_FUNCTION
(
this
);

92  
	gm_ty³
;

96 
	gMPEGH—d”
::
S‘Size
(
ušt32_t
 
size
)

98 
NS_LOG_FUNCTION
(
this
);

99 
	gm_size
 = 
size
;

102 
ušt32_t


103 
	gMPEGH—d”
::
G‘Size
() const

105 
NS_LOG_FUNCTION
(
this
);

106  
	gm_size
;

108 
Time


109 
	gMPEGH—d”
::
G‘Ts
() const

111 
NS_LOG_FUNCTION
(
this
);

112  
TimeS‹p
(
m_ts
);

115 
Ty³Id


116 
	gMPEGH—d”
::
G‘Ty³Id
()

118 
Ty³Id
 
tid
 =

119 
Ty³Id
("ns3::MPEGH—d”").
S‘P¬’t
<
H—d”
>().
AddCÚ¡ruùÜ
<
MPEGH—d”
>();

120  
	gtid
;

122 
Ty³Id


123 
	gMPEGH—d”
::
G‘In¡ªûTy³Id
() const

125  
G‘Ty³Id
();

128 
	gMPEGH—d”
::
Pršt
(
¡d
::
o¡»am
 &
os
) const

130 
NS_LOG_FUNCTION
(
this
 << &
os
);

131 
	gos
 << "(£q=" << 
	gm_£q
 << "ime=" << 
TimeS‹p
(
m_ts
).
G‘SecÚds
() << ")";

133 
ušt32_t


134 
	gMPEGH—d”
::
G‘S”ŸlizedSize
() const

136 
NS_LOG_FUNCTION
(
this
);

141 
	gMPEGH—d”
::
S”Ÿlize
(
Bufãr
::
I‹¿tÜ
 
¡¬t
) const

143 
NS_LOG_FUNCTION
(
this
 << &
¡¬t
);

144 
	gBufãr
::
I‹¿tÜ
 
i
 = 
¡¬t
;

145 
	gi
.
Wr™eHtÚU32
(
m_£q
);

146 
	gi
.
Wr™eHtÚU64
(
m_ts
);

147 
	gi
.
Wr™eHtÚU32
(
m_äame_id
);

148 
	gi
.
Wr™eHtÚU64
(
m_¶ayback_time
);

149 
	gi
.
Wr™eHtÚU32
(
m_ty³
);

150 
	gi
.
Wr™eHtÚU32
(
m_size
);

152 
ušt32_t


153 
	gMPEGH—d”
::
De£rŸlize
(
Bufãr
::
I‹¿tÜ
 
¡¬t
)

155 
NS_LOG_FUNCTION
(
this
 << &
¡¬t
);

156 
	gBufãr
::
I‹¿tÜ
 
i
 = 
¡¬t
;

157 
	gm_£q
 = 
i
.
R—dNtohU32
();

158 
	gm_ts
 = 
i
.
R—dNtohU64
();

159 
	gm_äame_id
 = 
i
.
R—dNtohU32
();

160 
	gm_¶ayback_time
 = 
i
.
R—dNtohU64
();

161 
	gm_ty³
 = 
i
.
R—dNtohU32
();

162 
	gm_size
 = 
i
.
R—dNtohU32
();

163  
G‘S”ŸlizedSize
();

	@model/mpeg-header.h

21 #iâdeà
MPEG_HEADER_H


22 
	#MPEG_HEADER_H


	)

24 
	~"ns3/h—d”.h
"

25 
	~"ns3/n¡ime.h
"

27 
Çme¥aû
 
	gns3


37 
	#MPEG_MAX_MESSAGE
 100000

	)

38 
	#MPEG_FRAMES_PER_SEGMENT
 100

39 
	#MPEG_TIME_BETWEEN_FRAMES
 20

40 şas 
	cMPEGH—d”
 : 
public
 
H—d”


	)

42 
	gpublic
:

43 
MPEGH—d”
();

49 
S‘Seq
(
ušt32_t
 
£q
);

53 
ušt32_t


54 
G‘Seq
() const;

60 
S‘F¿meId
(
ušt32_t
 
äame_id
);

61 
ušt32_t


62 
G‘F¿meId
() const;

65 
S‘PÏybackTime
(
Time
 
¶ayback_time
);

66 
Time


67 
G‘PÏybackTime
() const;

70 
S‘Ty³
(
ušt32_t
 
ty³
);

71 
ušt32_t


72 
G‘Ty³
() const;

75 
S‘Size
(
ušt32_t
 
size
);

76 
ušt32_t


77 
G‘Size
() const;

79 
Time


80 
G‘Ts
() const;

82 
Ty³Id


83 
G‘Ty³Id
();

85 
vœtu®
 
ušt32_t


86 
G‘S”ŸlizedSize
() const;

88 
	g´iv©e
:

89 
vœtu®
 
Ty³Id


90 
G‘In¡ªûTy³Id
() const;

91 
vœtu®
 

92 
Pršt
(
¡d
::
o¡»am
 &
os
) const;

93 
vœtu®
 

94 
S”Ÿlize
(
Bufãr
::
I‹¿tÜ
 
¡¬t
) const;

95 
vœtu®
 
ušt32_t


96 
De£rŸlize
(
Bufãr
::
I‹¿tÜ
 
¡¬t
);

98 
ušt32_t
 
	gm_£q
;

99 
ušt64_t
 
	gm_ts
;

101 
ušt32_t
 
	gm_äame_id
;

102 
ušt64_t
 
	gm_¶ayback_time
;

103 
ušt32_t
 
	gm_ty³
;

104 
ušt32_t
 
	gm_size
;

	@model/mpeg-player.cc

21 
	~"ns3/log.h
"

22 
	~"ns3/n¡ime.h
"

23 
	~"ns3/simuÏtÜ.h
"

24 
	~"h‰p-h—d”.h
"

25 
	~"m³g-h—d”.h
"

26 
	~"m³g-¶ay”.h
"

27 
	~"dash-ş›Á.h
"

28 
	~<cm©h
>

30 
NS_LOG_COMPONENT_DEFINE
("MpegPlayer");

31 
Çme¥aû
 
	gns3


34 
	gM³gPÏy”
::
M³gPÏy”
() :

35 
m_¡©e
(
MPEG_PLAYER_NOT_STARTED
), 
m_š‹¼ru±iÚs
(0), 
m_tÙ®R©e
(0), 
m_mšR©e
(

36 100000000), 
m_äamesPÏyed
(0), 
m_bufãrD–ay
("0s")

38 
NS_LOG_FUNCTION
(
this
);

41 
	gM³gPÏy”
::~
M³gPÏy”
()

43 
NS_LOG_FUNCTION
(
this
);

47 
	gM³gPÏy”
::
G‘QueueSize
()

49  
m_queue
.
size
();

52 
Time


53 
	gM³gPÏy”
::
G‘R—lPÏyTime
(
Time
 
¶ayTime
)

55 
NS_LOG_INFO
(

56 " S¹: " << 
m_¡¬t_time
.
G‘SecÚds
(è<< " IÁ”: " << 
m_š‹¼u±iÚ_time
.G‘SecÚds(è<< "…Ïytime: " << 
¶ayTime
.G‘SecÚds(è<< "‚ow: " << 
SimuÏtÜ
::
Now
().GetSeconds() << "‡ctual: " << (m_start_time + m_interruption_time +…layTime).GetSeconds());

58  
	gm_¡¬t_time
 + 
	gm_š‹¼u±iÚ_time


59 + (
	gm_¡©e
 =ğ
MPEG_PLAYER_PAUSED
 ?

60 (
SimuÏtÜ
::
Now
(è- 
m_Ï¡·u£d
è: 
SecÚds
(0)è+ 
¶ayTime


61 - 
SimuÏtÜ
::
Now
();

65 
	gM³gPÏy”
::
ReûiveF¿me
(
PŒ
<
Pack‘
> 
mes§ge
)

67 
NS_LOG_FUNCTION
(
this
 << 
mes§ge
);

68 
NS_LOG_INFO
("Reûived F¿m" << 
m_¡©e
);

70 
	gPŒ
<
	gPack‘
> 
	gmsg
 = 
mes§ge
->
Cİy
();

72 
	gm_queue
.
push
(
msg
);

73 ià(
	gm_¡©e
 =ğ
MPEG_PLAYER_PAUSED
)

75 
NS_LOG_INFO
("Play„esumed");

76 
	gm_¡©e
 = 
MPEG_PLAYER_PLAYING
;

77 
	gm_š‹¼u±iÚ_time
 +ğ(
SimuÏtÜ
::
Now
(è- 
m_Ï¡·u£d
);

78 
PÏyF¿me
();

80 ià(
	gm_¡©e
 =ğ
MPEG_PLAYER_NOT_STARTED
)

82 
NS_LOG_INFO
("Play started");

83 
	gm_¡©e
 = 
MPEG_PLAYER_PLAYING
;

84 
	gm_¡¬t_time
 = 
SimuÏtÜ
::
Now
();

85 
	gSimuÏtÜ
::
ScheduË
(
SimuÏtÜ
::
Now
(), &
M³gPÏy”
::
PÏyF¿me
, 
this
);

90 
	gM³gPÏy”
::
S¹
()

92 
NS_LOG_FUNCTION
(
this
);

93 
	gm_¡©e
 = 
MPEG_PLAYER_PLAYING
;

94 
	gm_š‹¼u±iÚ_time
 = 
SecÚds
(0);

99 
	gM³gPÏy”
::
PÏyF¿me
()

102 
NS_LOG_FUNCTION
(
this
);

103 ià(
	gm_¡©e
 =ğ
MPEG_PLAYER_DONE
)

107 ià(
	gm_queue
.
em±y
())

109 
NS_LOG_INFO
(
SimuÏtÜ
::
Now
().
G‘SecÚds
() << " No frameso…lay");

110 
	gm_¡©e
 = 
MPEG_PLAYER_PAUSED
;

111 
	gm_Ï¡·u£d
 = 
SimuÏtÜ
::
Now
();

112 
	gm_š‹¼ru±iÚs
++;

115 
	gPŒ
<
	gPack‘
> 
	gmes§ge
 = 
m_queue
.
äÚt
();

116 
	gm_queue
.
pİ
();

118 
MPEGH—d”
 
	gm³g_h—d”
;

119 
HTTPH—d”
 
	gh‰p_h—d”
;

121 
	gmes§ge
->
RemoveH—d”
(
m³g_h—d”
);

122 
	gmes§ge
->
RemoveH—d”
(
h‰p_h—d”
);

124 
	gm_tÙ®R©e
 +ğ
h‰p_h—d”
.
G‘ResŞutiÚ
();

125 ià(
	gh‰p_h—d”
.
G‘Segm’tId
() > 0)

127 
	gm_mšR©e
 =

128 
h‰p_h—d”
.
G‘ResŞutiÚ
(è< 
m_mšR©e
 ?

129 
h‰p_h—d”
.
G‘ResŞutiÚ
(è: 
m_mšR©e
;

131 
	gm_äamesPÏyed
++;

136 
Time
 
	gb_t
 = 
G‘R—lPÏyTime
(
m³g_h—d”
.
G‘PÏybackTime
());

138 ià(
	gm_bufãrD–ay
 > 
Time
("0s"è&& 
	gb_t
 < m_bufãrD–ay && 
	gm_dashCl›Á
)

140 
	gm_dashCl›Á
->
Reque¡Segm’t
();

141 
	gm_bufãrD–ay
 = 
SecÚds
(0);

142 
	gm_dashCl›Á
 = 
NULL
;

145 
NS_LOG_INFO
(

146 
SimuÏtÜ
::
Now
().
G‘SecÚds
(è<< " PLAYING FRAME: " << " VidId: " << 
h‰p_h—d”
.
G‘VideoId
(è<< " SegId: " << h‰p_h—d”.
G‘Segm’tId
(è<< " Res: " << h‰p_h—d”.
G‘ResŞutiÚ
(è<< " F¿meId: " << 
m³g_h—d”
.
G‘F¿meId
(è<< " PÏyTime: " << m³g_h—d”.
G‘PÏybackTime
().G‘SecÚds(è<< " Ty³: " << (èm³g_h—d”.
G‘Ty³
(è<< " iÁ”Time: " << 
m_š‹¼u±iÚ_time
.G‘SecÚds(è<< " queueL’gth: " << 
m_queue
.
size
());

154 
	gSimuÏtÜ
::
ScheduË
(
MliSecÚds
(2000), &
M³gPÏy”
::
PÏyF¿me
, 
this
);

	@model/mpeg-player.h

21 #iâdeà
MPEG_PLAYER_H_


22 
	#MPEG_PLAYER_H_


	)

24 
	~<queue
>

25 
	~<m­
>

26 
	~"ns3/±r.h
"

27 
	~"ns3/·ck‘.h
"

29 
Çme¥aû
 
	gns3


33 
	gMPEG_PLAYER_PAUSED
, 
	gMPEG_PLAYER_PLAYING
, 
	gMPEG_PLAYER_NOT_STARTED
, 
	gMPEG_PLAYER_DONE


36 
şass
 
	gDashCl›Á
;

38 şas 
	cM³gPÏy”


40 
	gpublic
:

41 
M³gPÏy”
();

43 
	gvœtu®


44 ~
M³gPÏy”
();

47 
ReûiveF¿me
(
PŒ
<
Pack‘
> 
mes§ge
);

50 
G‘QueueSize
();

53 
S¹
();

55 
Time


56 
G‘R—lPÏyTime
(
Time
 
¶ayTime
);

58 
šlše


59 
SchduËBufãrWakeup
(cÚ¡ 
Time
 
t
, 
DashCl›Á
 * 
ş›Á
)

61 
	gm_bufãrD–ay
 = 
t
;

62 
	gm_dashCl›Á
 = 
ş›Á
;

65 
	gm_¡©e
;

66 
Time
 
	gm_š‹¼u±iÚ_time
;

67 
	gm_š‹¼ru±iÚs
;

69 
Time
 
	gm_¡¬t_time
;

70 
ušt64_t
 
	gm_tÙ®R©e
;

71 
ušt32_t
 
	gm_mšR©e
;

72 
ušt32_t
 
	gm_äamesPÏyed
;

74 
	g´iv©e
:

76 
PÏyF¿me
();

78 
Time
 
	gm_Ï¡·u£d
;

79 
	g¡d
::
queue
<
PŒ
<
Pack‘
> > 
m_queue
;

80 
Time
 
	gm_bufãrD–ay
;

81 
DashCl›Á
 * 
	gm_dashCl›Á
;

	@model/para.h

1 
usšg
 
Çme¥aû
 
	g¡d
;

2 
	g¡d
::
¡ršg
 
check‹¡
;

4 
veùÜ
 <> 
video_num
;

	@test/dash-test-suite.cc

4 
	~"ns3/dash-moduË.h
"

7 
	~"ns3/‹¡.h
"

9 
	~<¡ršg
>

10 
	~<f¡»am
>

11 
	~"ns3/cÜe-moduË.h
"

12 
	~"ns3/pošt-to-pošt-moduË.h
"

13 
	~"ns3/š‹º‘-moduË.h
"

14 
	~"ns3/­¶iÿtiÚs-moduË.h
"

15 
	~"ns3/ÃtwÜk-moduË.h
"

16 
	~"ns3/dash-moduË.h
"

20 
usšg
 
Çme¥aû
 
	gns3
;

23 şas 
	cDashTe¡Ca£1
 : 
public
 
Te¡Ca£


25 
public
:

26 
DashTe¡Ca£1
 ();

27 
	mvœtu®
 ~
DashTe¡Ca£1
 ();

29 
	m´iv©e
:

30 
vœtu®
 
DoRun
 ();

34 
	gDashTe¡Ca£1
::
	$DashTe¡Ca£1
 ()

35 : 
	`Te¡Ca£
 ("Dashest case (does‚othing)")

37 
	}
}

41 
DashTe¡Ca£1
::~
	$DashTe¡Ca£1
 ()

43 
	}
}

50 
DashTe¡Ca£1
::
	$DoRun
 ()

53 
boŞ
 
Œacšg
 = 
çl£
;

54 
ušt32_t
 
u£rs
 = 1;

55 
rg‘_dt
 = 7;

56 
¡İTime
 = 100.0;

61 
NodeCÚš”
 
nodes
;

62 
nodes
.
	`C»©e
(2);

66 
PoštToPoštH–³r
 
poštToPošt
;

67 
poštToPošt
.
	`S‘DeviûA‰ribu‹
("D©aR©e", 
	`SŒšgV®ue
("500Kbps"));

68 
poštToPošt
.
	`S‘ChªÃlA‰ribu‹
("D–ay", 
	`SŒšgV®ue
("5ms"));

69 
N‘DeviûCÚš”
 
deviûs
;

70 
deviûs
 = 
poštToPošt
.
	`In¡®l
(
nodes
);

75 
IÁ”ÃtSckH–³r
 
š‹º‘
;

76 
š‹º‘
.
	`In¡®l
(
nodes
);

81 
Ipv4Add»ssH–³r
 
v4
;

82 
v4
.
	`S‘Ba£
("10.1.1.0", "255.255.255.0");

83 
Ipv4IÁ”çûCÚš”
 
i
 = 
v4
.
	`Assign
(
deviûs
);

87 
ušt16_t
 
pÜt
 = 80;

89 
¡d
::
veùÜ
<
DashCl›ÁH–³r
> 
ş›Ás
;

90 
¡d
::
veùÜ
<
AµliÿtiÚCÚš”
> 
ş›ÁAµs
;

92 
ušt32_t
 
u£r
 = 1; u£¸<ğ
u£rs
; user++)

94 
DashCl›ÁH–³r
 
	`ş›Á
("ns3::TcpSocketFactory",

95 
	`IÃtSock‘Add»ss
(
i
.
	`G‘Add»ss
(1), 
pÜt
));

97 
ş›Á
.
	`S‘A‰ribu‹
("VideoId", 
	`Uš‹g”V®ue
(
u£r
));

98 
ş›Á
.
	`S‘A‰ribu‹
("wšdow", 
	`TimeV®ue
(
	`SecÚds
(
rg‘_dt
)));

99 
AµliÿtiÚCÚš”
 
ş›ÁAµ
 = 
ş›Á
.
	`In¡®l
(
nodes
.
	`G‘
(0));

100 
ş›ÁAµ
.
	`S¹
(
	`SecÚds
(1.0));

101 
ş›ÁAµ
.
	`Stİ
(
	`SecÚds
(
¡İTime
));

103 
ş›Ás
.
	`push_back
(
ş›Á
);

104 
ş›ÁAµs
.
	`push_back
(
ş›ÁAµ
);

108 
DashS”v”H–³r
 
	`£rv”
("ns3::TcpSocketFactory",

109 
	`IÃtSock‘Add»ss
(
Ipv4Add»ss
::
	`G‘Any
(), 
pÜt
));

110 
AµliÿtiÚCÚš”
 
£rv”Aµs
 = 
£rv”
.
	`In¡®l
(
nodes
.
	`G‘
(1));

111 
£rv”Aµs
.
	`S¹
(
	`SecÚds
(0.0));

112 
£rv”Aµs
.
	`Stİ
(
	`SecÚds
(
¡İTime
 + 5.0));

117 ià(
Œacšg
)

119 
AsciiT¿ûH–³r
 
ascii
;

120 
poštToPošt
.
	`EÇbËAsciiAÎ
(
ascii
.
	`C»©eFeSŒ—m
("dash-send.tr"));

121 
poštToPošt
.
	`EÇbËPÿpAÎ
("dash-£nd", 
çl£
);

128 
SimuÏtÜ
::
	`Run
();

129 
SimuÏtÜ
::
	`De¡roy
();

131 
ušt32_t
 
k
;

132 
k
 = 0; k < 
u£rs
; k++)

134 
PŒ
<
DashCl›Á
> 
­p
 = 
DyÇmicCa¡
<DashCl›Á>(
ş›ÁAµs
[
k
].
	`G‘
(0));

135 
¡d
::
cout
 << "Node: " << 
k
;

136 
­p
->
	`G‘Sts
();

140 
	`NS_TEST_ASSERT_MSG_EQ
 (
Œue
,rue, "true doesn'tƒqualrue for some„eason");

142 
	`NS_TEST_ASSERT_MSG_EQ_TOL
 (0.01, 0.01, 0.001, "Numbers‡re‚otƒqual withinolerance");

143 
	}
}

149 şas 
	cDashTe¡Su™e
 : 
public
 
Te¡Su™e


151 
public
:

152 
DashTe¡Su™e
 ();

155 
	gDashTe¡Su™e
::
	$DashTe¡Su™e
 ()

156 : 
	`Te¡Su™e
 ("dash", 
UNIT
)

159 
	`AddTe¡Ca£
 (
Ãw
 
DashTe¡Ca£1
, 
Te¡Ca£
::
QUICK
);

160 
	}
}

163 
DashTe¡Su™e
 
	gdashTe¡Su™e
;

	@/usr/include/stdint.h

22 #iâdeà
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/wch¬.h
>

27 
	~<b™s/wÜdsize.h
>

34 #iâdeà
__št8_t_defšed


35 
	#__št8_t_defšed


	)

36 sigÃd 
	tšt8_t
;

37 
	tšt16_t
;

38 
	tšt32_t
;

39 #ià
__WORDSIZE
 == 64

40 
	tšt64_t
;

42 
__ex‹nsiÚ__


43 
	tšt64_t
;

48 
	tušt8_t
;

49 
	tušt16_t
;

50 #iâdeà
__ušt32_t_defšed


51 
	tušt32_t
;

52 
	#__ušt32_t_defšed


	)

54 #ià
__WORDSIZE
 == 64

55 
	tušt64_t
;

57 
__ex‹nsiÚ__


58 
	tušt64_t
;

65 sigÃd 
	tšt_Ëa¡8_t
;

66 
	tšt_Ëa¡16_t
;

67 
	tšt_Ëa¡32_t
;

68 #ià
__WORDSIZE
 == 64

69 
	tšt_Ëa¡64_t
;

71 
__ex‹nsiÚ__


72 
	tšt_Ëa¡64_t
;

76 
	tušt_Ëa¡8_t
;

77 
	tušt_Ëa¡16_t
;

78 
	tušt_Ëa¡32_t
;

79 #ià
__WORDSIZE
 == 64

80 
	tušt_Ëa¡64_t
;

82 
__ex‹nsiÚ__


83 
	tušt_Ëa¡64_t
;

90 sigÃd 
	tšt_ç¡8_t
;

91 #ià
__WORDSIZE
 == 64

92 
	tšt_ç¡16_t
;

93 
	tšt_ç¡32_t
;

94 
	tšt_ç¡64_t
;

96 
	tšt_ç¡16_t
;

97 
	tšt_ç¡32_t
;

98 
__ex‹nsiÚ__


99 
	tšt_ç¡64_t
;

103 
	tušt_ç¡8_t
;

104 #ià
__WORDSIZE
 == 64

105 
	tušt_ç¡16_t
;

106 
	tušt_ç¡32_t
;

107 
	tušt_ç¡64_t
;

109 
	tušt_ç¡16_t
;

110 
	tušt_ç¡32_t
;

111 
__ex‹nsiÚ__


112 
	tušt_ç¡64_t
;

117 #ià
__WORDSIZE
 == 64

118 #iâdeà
__šŒ_t_defšed


119 
	tšŒ_t
;

120 
	#__šŒ_t_defšed


	)

122 
	tušŒ_t
;

124 #iâdeà
__šŒ_t_defšed


125 
	tšŒ_t
;

126 
	#__šŒ_t_defšed


	)

128 
	tušŒ_t
;

133 #ià
__WORDSIZE
 == 64

134 
	tštmax_t
;

135 
	tuštmax_t
;

137 
__ex‹nsiÚ__


138 
	tštmax_t
;

139 
__ex‹nsiÚ__


140 
	tuštmax_t
;

144 #ià
__WORDSIZE
 == 64

145 
	#__INT64_C
(
c
èø## 
L


	)

146 
	#__UINT64_C
(
c
èø## 
UL


	)

148 
	#__INT64_C
(
c
èø## 
LL


	)

149 
	#__UINT64_C
(
c
èø## 
ULL


	)

155 
	#INT8_MIN
 (-128)

	)

156 
	#INT16_MIN
 (-32767-1)

	)

157 
	#INT32_MIN
 (-2147483647-1)

	)

158 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

160 
	#INT8_MAX
 (127)

	)

161 
	#INT16_MAX
 (32767)

	)

162 
	#INT32_MAX
 (2147483647)

	)

163 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

166 
	#UINT8_MAX
 (255)

	)

167 
	#UINT16_MAX
 (65535)

	)

168 
	#UINT32_MAX
 (4294967295U)

	)

169 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

173 
	#INT_LEAST8_MIN
 (-128)

	)

174 
	#INT_LEAST16_MIN
 (-32767-1)

	)

175 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

176 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

178 
	#INT_LEAST8_MAX
 (127)

	)

179 
	#INT_LEAST16_MAX
 (32767)

	)

180 
	#INT_LEAST32_MAX
 (2147483647)

	)

181 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

184 
	#UINT_LEAST8_MAX
 (255)

	)

185 
	#UINT_LEAST16_MAX
 (65535)

	)

186 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

187 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

191 
	#INT_FAST8_MIN
 (-128)

	)

192 #ià
__WORDSIZE
 == 64

193 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

194 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

196 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

197 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

199 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

201 
	#INT_FAST8_MAX
 (127)

	)

202 #ià
__WORDSIZE
 == 64

203 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

204 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

206 
	#INT_FAST16_MAX
 (2147483647)

	)

207 
	#INT_FAST32_MAX
 (2147483647)

	)

209 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINT_FAST8_MAX
 (255)

	)

213 #ià
__WORDSIZE
 == 64

214 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

215 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

217 
	#UINT_FAST16_MAX
 (4294967295U)

	)

218 
	#UINT_FAST32_MAX
 (4294967295U)

	)

220 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

224 #ià
__WORDSIZE
 == 64

225 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

226 
	#INTPTR_MAX
 (9223372036854775807L)

	)

227 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

229 
	#INTPTR_MIN
 (-2147483647-1)

	)

230 
	#INTPTR_MAX
 (2147483647)

	)

231 
	#UINTPTR_MAX
 (4294967295U)

	)

236 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

238 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

241 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

247 #ià
__WORDSIZE
 == 64

248 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

249 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

251 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

252 
	#PTRDIFF_MAX
 (2147483647)

	)

256 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

257 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

260 #ià
__WORDSIZE
 == 64

261 
	#SIZE_MAX
 (18446744073709551615UL)

	)

263 #ifdeà
__WORDSIZE32_SIZE_ULONG


264 
	#SIZE_MAX
 (4294967295UL)

	)

266 
	#SIZE_MAX
 (4294967295U)

	)

271 #iâdeà
WCHAR_MIN


273 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

274 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

278 
	#WINT_MIN
 (0u)

	)

279 
	#WINT_MAX
 (4294967295u)

	)

282 
	#INT8_C
(
c
è
	)
c

283 
	#INT16_C
(
c
è
	)
c

284 
	#INT32_C
(
c
è
	)
c

285 #ià
__WORDSIZE
 == 64

286 
	#INT64_C
(
c
èø## 
L


	)

288 
	#INT64_C
(
c
èø## 
LL


	)

292 
	#UINT8_C
(
c
è
	)
c

293 
	#UINT16_C
(
c
è
	)
c

294 
	#UINT32_C
(
c
èø## 
U


	)

295 #ià
__WORDSIZE
 == 64

296 
	#UINT64_C
(
c
èø## 
UL


	)

298 
	#UINT64_C
(
c
èø## 
ULL


	)

302 #ià
__WORDSIZE
 == 64

303 
	#INTMAX_C
(
c
èø## 
L


	)

304 
	#UINTMAX_C
(
c
èø## 
UL


	)

306 
	#INTMAX_C
(
c
èø## 
LL


	)

307 
	#UINTMAX_C
(
c
èø## 
ULL


	)

	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

97 #undeà
__USE_ISOC11


98 #undeà
__USE_ISOC99


99 #undeà
__USE_ISOC95


100 #undeà
__USE_ISOCXX11


101 #undeà
__USE_POSIX


102 #undeà
__USE_POSIX2


103 #undeà
__USE_POSIX199309


104 #undeà
__USE_POSIX199506


105 #undeà
__USE_XOPEN


106 #undeà
__USE_XOPEN_EXTENDED


107 #undeà
__USE_UNIX98


108 #undeà
__USE_XOPEN2K


109 #undeà
__USE_XOPEN2KXSI


110 #undeà
__USE_XOPEN2K8


111 #undeà
__USE_XOPEN2K8XSI


112 #undeà
__USE_LARGEFILE


113 #undeà
__USE_LARGEFILE64


114 #undeà
__USE_FILE_OFFSET64


115 #undeà
__USE_MISC


116 #undeà
__USE_ATFILE


117 #undeà
__USE_GNU


118 #undeà
__USE_REENTRANT


119 #undeà
__USE_FORTIFY_LEVEL


120 #undeà
__KERNEL_STRICT_NAMES


124 #iâdeà
_LOOSE_KERNEL_NAMES


125 
	#__KERNEL_STRICT_NAMES


	)

135 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


136 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

137 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

139 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

146 #ià(
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE
) \

147 && !
defšed
 
	g_DEFAULT_SOURCE


152 #undeà
_DEFAULT_SOURCE


153 
	#_DEFAULT_SOURCE
 1

	)

157 #ifdeà
_GNU_SOURCE


158 #undeà
_ISOC95_SOURCE


159 
	#_ISOC95_SOURCE
 1

	)

160 #undeà
_ISOC99_SOURCE


161 
	#_ISOC99_SOURCE
 1

	)

162 #undeà
_ISOC11_SOURCE


163 
	#_ISOC11_SOURCE
 1

	)

164 #undeà
_POSIX_SOURCE


165 
	#_POSIX_SOURCE
 1

	)

166 #undeà
_POSIX_C_SOURCE


167 
	#_POSIX_C_SOURCE
 200809L

	)

168 #undeà
_XOPEN_SOURCE


169 
	#_XOPEN_SOURCE
 700

	)

170 #undeà
_XOPEN_SOURCE_EXTENDED


171 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

172 #undeà
_LARGEFILE64_SOURCE


173 
	#_LARGEFILE64_SOURCE
 1

	)

174 #undeà
_DEFAULT_SOURCE


175 
	#_DEFAULT_SOURCE
 1

	)

176 #undeà
_ATFILE_SOURCE


177 
	#_ATFILE_SOURCE
 1

	)

182 #ià(
defšed
 
_DEFAULT_SOURCE
 \

183 || (!
defšed
 
	g__STRICT_ANSI__
 \

184 && !
defšed
 
	g_ISOC99_SOURCE
 \

185 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

186 && !
defšed
 
	g_XOPEN_SOURCE
))

187 #undeà
_DEFAULT_SOURCE


188 
	#_DEFAULT_SOURCE
 1

	)

192 #ià(
defšed
 
_ISOC11_SOURCE
 \

193 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

194 
	#__USE_ISOC11
 1

	)

198 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

199 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

200 
	#__USE_ISOC99
 1

	)

204 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

205 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

206 
	#__USE_ISOC95
 1

	)

213 #ià((
defšed
 
__ılu¥lus
 && __cplusplus >= 201103L) \

214 || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__
)

215 
	#__USE_ISOCXX11
 1

	)

221 #ifdeà
_DEFAULT_SOURCE


222 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


223 
	#__USE_POSIX_IMPLICITLY
 1

	)

225 #undeà
_POSIX_SOURCE


226 
	#_POSIX_SOURCE
 1

	)

227 #undeà
_POSIX_C_SOURCE


228 
	#_POSIX_C_SOURCE
 200809L

	)

230 #ià((!
defšed
 
__STRICT_ANSI__
 \

231 || (
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

232 && !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

233 
	#_POSIX_SOURCE
 1

	)

234 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

235 
	#_POSIX_C_SOURCE
 2

	)

236 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

237 
	#_POSIX_C_SOURCE
 199506L

	)

238 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

239 
	#_POSIX_C_SOURCE
 200112L

	)

241 
	#_POSIX_C_SOURCE
 200809L

	)

243 
	#__USE_POSIX_IMPLICITLY
 1

	)

246 #ià(
defšed
 
_POSIX_SOURCE
 \

247 || (
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

248 || 
defšed
 
_XOPEN_SOURCE
)

249 
	#__USE_POSIX
 1

	)

252 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


253 
	#__USE_POSIX2
 1

	)

256 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

257 
	#__USE_POSIX199309
 1

	)

260 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

261 
	#__USE_POSIX199506
 1

	)

264 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

265 
	#__USE_XOPEN2K
 1

	)

266 #undeà
__USE_ISOC95


267 
	#__USE_ISOC95
 1

	)

268 #undeà
__USE_ISOC99


269 
	#__USE_ISOC99
 1

	)

272 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

273 
	#__USE_XOPEN2K8
 1

	)

274 #undeà
_ATFILE_SOURCE


275 
	#_ATFILE_SOURCE
 1

	)

278 #ifdef 
_XOPEN_SOURCE


279 
	#__USE_XOPEN
 1

	)

280 #ià(
_XOPEN_SOURCE
 - 0) >= 500

281 
	#__USE_XOPEN_EXTENDED
 1

	)

282 
	#__USE_UNIX98
 1

	)

283 #undeà
_LARGEFILE_SOURCE


284 
	#_LARGEFILE_SOURCE
 1

	)

285 #ià(
_XOPEN_SOURCE
 - 0) >= 600

286 #ià(
_XOPEN_SOURCE
 - 0) >= 700

287 
	#__USE_XOPEN2K8
 1

	)

288 
	#__USE_XOPEN2K8XSI
 1

	)

290 
	#__USE_XOPEN2K
 1

	)

291 
	#__USE_XOPEN2KXSI
 1

	)

292 #undeà
__USE_ISOC95


293 
	#__USE_ISOC95
 1

	)

294 #undeà
__USE_ISOC99


295 
	#__USE_ISOC99
 1

	)

298 #ifdeà
_XOPEN_SOURCE_EXTENDED


299 
	#__USE_XOPEN_EXTENDED
 1

	)

304 #ifdeà
_LARGEFILE_SOURCE


305 
	#__USE_LARGEFILE
 1

	)

308 #ifdeà
_LARGEFILE64_SOURCE


309 
	#__USE_LARGEFILE64
 1

	)

312 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

313 
	#__USE_FILE_OFFSET64
 1

	)

316 #ià
defšed
 
_DEFAULT_SOURCE


317 
	#__USE_MISC
 1

	)

320 #ifdef 
_ATFILE_SOURCE


321 
	#__USE_ATFILE
 1

	)

324 #ifdef 
_GNU_SOURCE


325 
	#__USE_GNU
 1

	)

328 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


329 
	#__USE_REENTRANT
 1

	)

332 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

333 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

334 #ià
_FORTIFY_SOURCE
 > 1

335 
	#__USE_FORTIFY_LEVEL
 2

	)

337 
	#__USE_FORTIFY_LEVEL
 1

	)

340 
	#__USE_FORTIFY_LEVEL
 0

	)

345 
	~<¡dc-´edef.h
>

353 #undeà
__GNU_LIBRARY__


354 
	#__GNU_LIBRARY__
 6

	)

358 
	#__GLIBC__
 2

	)

359 
	#__GLIBC_MINOR__
 23

	)

361 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

362 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

365 #iâdeà
__ASSEMBLER__


366 #iâdeà
_SYS_CDEFS_H


367 
	~<sys/cdefs.h
>

372 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


373 
	#__USE_LARGEFILE
 1

	)

374 
	#__USE_LARGEFILE64
 1

	)

380 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

381 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

382 && 
defšed
 
	g__ex‹º_šlše


383 
	#__USE_EXTERN_INLINES
 1

	)

391 
	~<gnu/¡ubs.h
>

	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

55 
	#__STDC_ISO_10646__
 201505L

	)

58 
	#__STDC_NO_THREADS__
 1

	)

	@
1
.
1
/usr/include
36
926
examples/dash-example.cc
examples/dash-wifi.cc
examples/link-example.cc
helper/dash-client-helper.cc
helper/dash-client-helper.h
helper/dash-server-helper.cc
helper/dash-server-helper.h
model/algorithms/aaash-client.cc
model/algorithms/aaash-client.h
model/algorithms/fdash-client.cc
model/algorithms/fdash-client.h
model/algorithms/osmp-client.cc
model/algorithms/osmp-client.h
model/algorithms/raahs-client.cc
model/algorithms/raahs-client.h
model/algorithms/sftm-client.cc
model/algorithms/sftm-client.h
model/algorithms/svaa-client.cc
model/algorithms/svaa-client.h
model/dash-client.cc
model/dash-client.h
model/dash-server.cc
model/dash-server.h
model/http-header.cc
model/http-header.h
model/http-parser.cc
model/http-parser.h
model/mpeg-header.cc
model/mpeg-header.h
model/mpeg-player.cc
model/mpeg-player.h
model/para.h
test/dash-test-suite.cc
/usr/include/stdint.h
/usr/include/features.h
/usr/include/stdc-predef.h
